{"version":3,"file":"forms-6de03ff0.js","sources":["../../src/core/SourceElementRelations.js","../../src/forms/formbuilder/FormBuilder.js","../../src/forms/formbuilder/FormField.js","../../src/forms/formbuilder/App.js","../../src/forms/FormSettings.js","../../src/forms/Integrations.js","../../src/forms/IntegrationModal.js"],"sourcesContent":["let $relationModal = $('#sprout-relations-modal');\n\nlet $modal = new Garnish.Modal($relationModal, {\n    autoShow: false,\n    closeOtherModals: false,\n    resizable: true,\n    onShow: function() {\n        let relationBtn = document.getElementById('sprout-relations-btn');\n\n        let data = {\n            elementId: relationBtn.dataset.elementId,\n        };\n\n        Craft.sendActionRequest('POST', 'sprout-module-core/source-element-relations/get-relations', {\n            data: data,\n        }).then((response) => {\n            if (response.data.success) {\n                $relationModal.html(response.data.html);\n            }\n        }).catch(() => {\n\n        });\n    },\n    onHide: function() {\n\n    },\n});\n\nlet sproutRelationBtn = document.querySelector('#sprout-relations-btn');\n\nif (sproutRelationBtn !== null) {\n    sproutRelationBtn.addEventListener('click', function(event) {\n        event.preventDefault();\n        $modal.show();\n    }, false);\n}\n","export const FormBuilder = (formId) => ({\n\n    formId: formId,\n\n    lastUpdatedFormFieldUid: null,\n\n    /**\n     * Array of field data\n     * [\n     *  id: 123,\n     *  type: className,\n     *  etc.\n     * ]\n     */\n    sourceFields: [],\n\n    /**\n     * [\n     *   {\n     *     id: 123,\n     *     label: 'X',\n     *     elements: [\n     *        {\n     *          id: 123,\n     *          name: 'Y',\n     *          required,\n     *          getExampleHtml(),\n     *          getSettingsHtml(),\n     *        },\n     *        {},\n     *        {}\n     *      ]\n     *   }\n     * ]\n     */\n    tabs: [],\n    fields: [],\n    uiSettings: [],\n\n    fieldLayoutUid: null,\n\n    selectedTabUid: null,\n    editTabUid: null,\n    editFieldUid: null,\n\n    dragOrigin: null,\n\n    DragOrigins: {\n        sourceField: 'source-field',\n        layoutField: 'layout-field',\n        layoutTabNav: 'layout-tab-nav',\n    },\n\n    isDraggingTabUid: null,\n    isDragOverTabUid: null,\n\n    isDraggingFormFieldUid: null,\n    isDragOverFormFieldUid: null,\n\n    init() {\n\n        let self = this;\n        // Get the saved fieldLayout data\n        Craft.sendActionRequest('POST', 'sprout-module-forms/forms/get-submission-field-layout', {\n            data: {\n                formId: this.formId,\n            },\n        }).then((response) => {\n            console.log('get-submission-field-layout', response);\n            // self.tabs = [\n            //   {\n            //     id: 123,\n            //     label: 'Tab 1',\n            //     fields: [],\n            //   },\n            // ];\n            self.tabs = response.data.layout.tabs;\n            // self.fields = response.data.layout.fields;\n            // self.uiSettings = response.data.layout.uiSettings;\n            self.fieldLayoutUid = response.data.layout.uid;\n\n            // get uid of first tab in tabs array\n            self.selectedTabUid = self.tabs[0].uid ?? null;\n\n            self.ensureTabUids();\n        }).catch(() => {\n            console.log('No form data found.');\n        });\n\n        window.formBuilder = this;\n\n        let sourceFields = JSON.parse(this.$refs.formBuilder.dataset.sourceFields);\n\n        for (const field of sourceFields) {\n\n            // const {type, name, icon, groupName, order, exampleInputHtml, ...fieldAttributes} = field;\n            this.sourceFields.push(field);\n            // this.sourceFields.push({\n            //   type: type,\n            //   name: name,\n            //   icon: icon,\n            //   groupName: groupName,\n            //   order: order,\n            //   exampleInputHtml: exampleInputHtml,\n            // });\n            //\n            // this.defaultFieldAttributes[type] = fieldAttributes;\n            // this.defaultFieldAttributes[type].name = name;\n        }\n    },\n\n    ensureTabUids() {\n        for (const tab of this.tabs) {\n            if (tab.uid === null) {\n                tab.uid = Craft.uuid();\n\n                // Saved tabs will already have an ID\n                if (this.selectedTabUid === null) {\n                    this.selectedTabUid = tab.uid;\n                }\n            }\n        }\n    },\n\n    get fieldLayoutInputValue() {\n\n        let fieldLayout = {};\n\n        if (this.tabs.length && !this.tabs[0].elements.length) {\n            return [];\n        }\n\n        let fieldLayoutTabs = [];\n\n        for (const tab of this.tabs) {\n\n            let fieldLayoutFields = [];\n\n            for (const element of tab.elements) {\n\n                let field = this.getFormFieldAttributes(element);\n\n                fieldLayoutFields.push(field);\n            }\n\n            fieldLayoutTabs.push({\n                id: tab.uid, // remove\n                uid: tab.uid,\n                name: tab.name,\n                sortOrder: null,\n                userCondition: null,\n                elementCondition: null,\n                elements: fieldLayoutFields,\n            });\n        }\n\n        fieldLayout['tabs'] = fieldLayoutTabs;\n\n        return JSON.stringify(fieldLayout);\n    },\n\n    // Removes uiSettings from element/field data\n    getFormFieldAttributes(fieldData) {\n\n        const {\n            uiSettings,\n            ...fieldAttributes\n        } = fieldData;\n\n        return fieldAttributes;\n    },\n\n    // Drag Actions\n\n    dragStartLayoutTabNav(e) {\n        console.log('dragStartLayoutTabNav');\n\n        e.dataTransfer.setData('sprout/origin-page-tab-uid', e.target.dataset.tabUid);\n        this.dragOrigin = this.DragOrigins.layoutTabNav;\n        this.isDraggingTabUid = this.normalizeTypes(e.target.dataset.tabUid);\n\n        // e.dataTransfer.dropEffect = 'link';\n        // e.dataTransfer.effectAllowed = 'copyLink';\n    },\n\n    dragEndLayoutTabNav(e) {\n        console.log('dragEndLayoutTabNav');\n\n        this.dragOrigin = null;\n        this.isDraggingTabUid = null;\n        this.isDragOverTabUid = null;\n    },\n\n    dragEnterLayoutTabNav(e) {\n        console.log('dragEnterLayoutTabNav');\n        e.target.classList.add('no-pointer-events');\n    },\n\n    dragLeaveLayoutTabNav(e) {\n        console.log('dragLeaveLayoutTabNav');\n        e.target.classList.remove('no-pointer-events');\n    },\n\n    dragOverLayoutTabNav(e) {\n        let self = this;\n\n        if (this.dragOrigin === this.DragOrigins.layoutTabNav) {\n\n        }\n\n        if (this.dragOrigin === this.DragOrigins.sourceField || this.dragOrigin === this.DragOrigins.layoutField) {\n            setTimeout(function() {\n                self.selectedTabUid = self.normalizeTypes(e.target.dataset.tabUid);\n            }, 1000);\n        }\n    },\n\n    dropOnLayoutTabNav(e) {\n        console.log('dropOnLayoutTabNav');\n\n        let self = this;\n\n        let originTabUid = self.normalizeTypes(e.dataTransfer.getData('sprout/origin-page-tab-uid'));\n        let targetTabUid = self.normalizeTypes(e.target.dataset.tabUid);\n\n        if (this.dragOrigin === this.DragOrigins.layoutTabNav) {\n            this.updateTabPosition(originTabUid, targetTabUid);\n            this.selectedTabUid = originTabUid;\n        }\n\n        if (this.dragOrigin === this.DragOrigins.sourceField) {\n            let type = e.dataTransfer.getData('sprout/field-type');\n            this.addFieldToLayoutTab(type);\n        }\n\n        if (this.dragOrigin === this.DragOrigins.layoutField) {\n\n            this.updateFieldPositionOnNewTab(self.isDraggingFormFieldUid, originTabUid, targetTabUid);\n        }\n    },\n\n    dragStartSourceField(e) {\n        console.log('dragStartSourceField');\n\n        this.dragOrigin = this.DragOrigins.sourceField;\n\n        e.dataTransfer.setData('sprout/field-type', e.target.dataset.type);\n\n        // e.dataTransfer.dropEffect = 'link';\n        // e.dataTransfer.effectAllowed = 'copyLink';\n    },\n\n    dragEndSourceField(e) {\n        console.log('dragEndSourceField');\n\n        this.isDraggingFormFieldUid = null;\n        this.isDragOverFormFieldUid = null;\n    },\n\n    dragStartLayoutField(e) {\n        console.log('dragStartLayoutField');\n\n        let self = this;\n\n        // Store selected tab in drag object as it might change before the drop event\n        e.dataTransfer.setData('sprout/origin-page-tab-uid', this.selectedTabUid);\n        e.dataTransfer.setData('sprout/field-type', e.target.dataset.type);\n        this.dragOrigin = this.DragOrigins.layoutField;\n        this.isDraggingTabUid = this.normalizeTypes(e.target.dataset.tabUid);\n        this.isDraggingFormFieldUid = this.normalizeTypes(e.target.dataset.fieldUid);\n\n        // Need setTimeout before manipulating dom:\n        // https://stackoverflow.com/questions/19639969/html5-dragend-event-firing-immediately\n        // setTimeout(function() {\n        //   self.isDraggingFormFieldUid = isDraggingFormFieldUid;\n        // }, 10);\n\n        // e.dataTransfer.dropEffect = 'move';\n        // e.dataTransfer.effectAllowed = 'move';\n\n        // Handle scroll stuff: https://stackoverflow.com/a/72807140/1586560\n        // On drag scroll, prevents page from growing with mobile safari rubber-band effect\n        // let VerticalMaxed = (window.innerHeight + window.scrollY) >= document.body.offsetHeight;\n        //\n        // this.scrollActive = true;\n        //\n        // if (e.clientY < 150) {\n        //   this.scrollActive = false;\n        //   this.scrollFieldLayout(-1);\n        // }\n        //\n        // if ((e.clientY > (document.documentElement.clientHeight - 150)) && !VerticalMaxed) {\n        //   this.scrollActive = false;\n        //   this.scrollFieldLayout(1)\n        // }\n    },\n\n    dragEndLayoutField(e) {\n        console.log('dragEndLayoutField');\n\n        // Reset scrolling\n        // this.scrollActive = false;\n\n        this.isDraggingFormFieldUid = null;\n        this.isDragOverFormFieldUid = null;\n    },\n\n    dragEnterLayoutTabBody(e) {\n        console.log('dragEnterLayoutTabBody');\n\n        this.isDragOverTabUid = this.selectedTabUid;\n    },\n\n    dragLeaveLayoutTabBody(e) {\n        console.log('dragLeaveLayoutTabBody');\n\n        this.isDragOverTabUid = null;\n    },\n\n    dropOnLayoutTabBody(e) {\n        console.log('dropOnLayoutTabBody');\n        let self = this;\n\n        let type = e.dataTransfer.getData('sprout/field-type');\n\n        if (this.dragOrigin === this.DragOrigins.sourceField) {\n            this.addFieldToLayoutTab(type);\n        }\n\n        if (this.dragOrigin === this.DragOrigins.layoutField) {\n\n            let dropBeforeTargetFieldUid = this.normalizeTypes(e.target.dataset.fieldUid);\n\n            this.updateFieldPosition(self.isDraggingFormFieldUid, dropBeforeTargetFieldUid);\n        }\n    },\n\n    dragEnterLayoutField(e) {\n        console.log('dragEnterLayoutField');\n        e.target.classList.add('no-pointer-events');\n\n    },\n\n    dragLeaveLayoutField(e) {\n        console.log('dragLeaveLayoutField');\n        e.target.classList.remove('no-pointer-events');\n    },\n\n    dropOnExistingLayoutField(e) {\n        console.log('dropOnExistingLayoutField');\n        let self = this;\n\n        // let fieldUid = e.dataTransfer.getData('sprout/field-id');\n        let type = e.dataTransfer.getData('sprout/field-type');\n\n        let dropBeforeTargetFieldUid = e.target.dataset.fieldUid;\n\n        if (this.dragOrigin === this.DragOrigins.layoutField) {\n            this.updateFieldPosition(self.isDraggingFormFieldUid, dropBeforeTargetFieldUid);\n        } else {\n            this.addFieldToLayoutTab(type, dropBeforeTargetFieldUid);\n        }\n    },\n\n    dragEnterFieldLayoutEndZone(e) {\n        console.log('dragEnterFieldLayoutEndZone');\n\n        // this.isMouseOverEndZone = true;\n    },\n\n    dragLeaveFieldLayoutEndZone(e) {\n        console.log('dragLeaveFieldLayoutEndZone');\n\n        // this.isMouseOverEndZone = false;\n    },\n\n    dropOnLayoutEndZone(e) {\n        console.log('dropOnLayoutEndZone');\n        let self = this;\n\n        let type = e.dataTransfer.getData('sprout/field-type');\n        // let fieldUid = e.dataTransfer.getData('sprout/field-id');\n\n        if (this.dragOrigin === this.DragOrigins.sourceField) {\n            console.log('addFieldToLayoutTab');\n            this.addFieldToLayoutTab(type);\n        } else {\n            console.log('updateFieldPosition');\n            this.updateFieldPosition(self.isDraggingFormFieldUid);\n        }\n    },\n\n    // See specifying drop targets docs:\n    // https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API/Drag_operations#specifying_drop_targets\n    dragOverLayoutTabBody(e) {\n        const isDraggingFormField = e.dataTransfer.types.includes('sprout/field-type');\n\n        if (isDraggingFormField) {\n            console.log('dragOverLayoutTabBody');\n            event.preventDefault();\n        }\n    },\n\n    dragOverLayoutField(e) {\n        const isDraggingLayoutField = e.dataTransfer.types.includes('sprout/field-type');\n\n        if (isDraggingLayoutField) {\n            // console.log('dragOverLayoutField');\n            event.preventDefault();\n        }\n    },\n\n    isOverFieldLayoutEndZone(e) {\n        const sproutFormField = e.dataTransfer.types.includes('sprout/field-type');\n\n        // this.isDragOverTabUid = this.selectedTabUid;\n        // this.isDragOverFormFieldUid = e.target.parentNode.dataset.fieldUid;\n\n\n        if (sproutFormField) {\n            console.log('isOverFieldLayoutEndZone');\n            event.preventDefault();\n        }\n    },\n\n    // Helper Methods\n\n    // Covert numbers to numbers and leave other data types as is\n    normalizeTypes(value) {\n        return Number.isNaN(parseInt(value)) ? value : parseInt(value);\n    },\n\n    getFieldsByGroup(handle) {\n        return this.sourceFields.filter(item => item.groupName === handle);\n    },\n\n    // Returns the field data for a given type\n    getFieldByType(type) {\n        return this.sourceFields.filter(item => item.field.type === type)[0] ?? null;\n    },\n\n    // getCurrentTabUidFromFieldUid(fieldUid) {\n    //     // loop through this.tabs and find the this.tabs.elements.id that matches\n    //     // return the field.tabUid\n    //     let self = this;\n    //     this.tabs.forEach(tab => {\n    //         let fieldIndex = self.getFieldIndexByFieldUid(tab, fieldUid);\n    //         if (fieldIndex > -1) {\n    //             return tab.elements[fieldIndex].tabUid;\n    //         }\n    //     });\n    // },\n\n    getTabIndexByTabUid(id) {\n        return this.tabs.findIndex(item => item.uid === id);\n    },\n\n    getFieldIndexByFieldUid(tab, fieldUid) {\n        // @todo - testing for == because we might have strings or numbers, fix at origin.\n        return tab.elements.findIndex(item => item.fieldUid == fieldUid);\n    },\n\n    updateTabSettings(tabUid, data) {\n        let tabIndex = this.getTabIndexByTabUid(tabUid);\n\n        // loop through js object\n        Object.entries(data).forEach(([index, value]) => {\n            this.tabs[tabIndex][index] = value;\n        });\n\n        if (!this.tabs[tabIndex]['name']) {\n            this.tabs[tabIndex]['name'] = 'Page';\n        }\n    },\n\n    updateFieldSettings(fieldUid, fieldSettings) {\n\n        let tabIndex = this.getTabIndexByTabUid(this.selectedTabUid);\n        let tab = this.tabs[tabIndex];\n\n        let fieldIndex = this.getFieldIndexByFieldUid(tab, fieldUid);\n        let targetField = tab.elements[fieldIndex];\n        //\n        // console.log(targetField);\n        // console.log(fieldSettings);\n\n        targetField.name = fieldSettings.name;\n        targetField.instructions = fieldSettings.instructions;\n        targetField.required = fieldSettings.required;\n        // // targetField.name = fieldSettings.name;\n        // // targetField.name = fieldSettings.name;\n        // console.log(targetField);\n\n\n\n        // console.log(fieldSettings)\n        targetField.settings = fieldSettings.settings;\n        // loop through fieldSettings.settings and update the targetField.settings\n        // console.log(fieldSettings);\n\n        tab.elements[fieldIndex] = targetField;\n    },\n\n    updateTabPosition(tabUid, beforeTabUid = null) {\n\n        let beforeTabIndex = this.getTabIndexByTabUid(beforeTabUid);\n        let tabIndex = this.getTabIndexByTabUid(tabUid);\n        let targetTab = this.tabs[tabIndex];\n\n        // console.log(this.tabs);\n        // Remove the updated tab\n        this.tabs.splice(tabIndex, 1);\n\n        if (beforeTabUid) {\n\n            // console.log('target' + targetTab);\n            // Insert the updated tab before the target tab\n            this.tabs.splice(beforeTabIndex, 0, targetTab);\n        } else {\n            this.tabs.push(targetTab);\n        }\n\n        this.lastUpdatedTabUid = targetTab.uid;\n    },\n\n    updateFieldPositionOnNewTab(fieldUid, originTabUid, targetTabUid) {\n\n        let self = this;\n\n        let targetTabIndex = this.getTabIndexByTabUid(targetTabUid);\n        let targetTab = this.tabs[targetTabIndex];\n\n        let originTabIndex = this.getTabIndexByTabUid(originTabUid);\n        let originTab = this.tabs[originTabIndex];\n\n        let fieldIndex = this.getFieldIndexByFieldUid(originTab, fieldUid);\n        let targetField = originTab.elements[fieldIndex];\n\n        // Remove the updated field from origin tab\n        originTab.elements.splice(fieldIndex, 1);\n\n        // Push field onto target tab\n        targetTab.elements.push(targetField);\n\n        // Update tab\n        this.tabs[targetTabIndex] = targetTab;\n\n        this.lastUpdatedFormFieldUid = targetField.id;\n\n        // The timeout here needs to match the time of the 'drop-highlight' css transition effect\n        setTimeout(function() {\n            self.lastUpdatedFormFieldUid = null;\n        }, 300);\n    },\n\n    updateFieldPosition(fieldUid, beforeFieldUid = null) {\n\n        let self = this;\n\n        let tabIndex = this.getTabIndexByTabUid(this.selectedTabUid);\n        let tab = this.tabs[tabIndex];\n\n        let fieldIndex = this.getFieldIndexByFieldUid(tab, fieldUid);\n        let targetField = tab.elements[fieldIndex];\n\n        // Remove the updated field\n        tab.elements.splice(fieldIndex, 1);\n\n        if (beforeFieldUid) {\n            // let beforeFieldIndex = tab.elements.length + 1;\n            let beforeFieldIndex = this.getFieldIndexByFieldUid(tab, beforeFieldUid);\n\n            // Insert the updated field before the target field\n            tab.elements.splice(beforeFieldIndex, 0, targetField);\n        } else {\n            tab.elements.push(targetField);\n        }\n\n        // Update tab\n        this.tabs[tabIndex] = tab;\n\n        this.lastUpdatedFormFieldUid = targetField.id;\n\n        // The timeout here needs to match the time of the 'drop-highlight' css transition effect\n        setTimeout(function() {\n            self.lastUpdatedFormFieldUid = null;\n        }, 300);\n    },\n\n    addFormPageButton() {\n        let tab = {\n            uid: Craft.uuid(),\n            name: 'Page 2',\n            elementCondition: null,\n            tabCondition: null,\n            elements: [],\n        };\n\n        this.tabs.push(tab);\n        this.selectedTabUid = newId;\n    },\n\n    addFieldToLayoutTab(type, beforeFieldUid) {\n\n        console.log('addFieldToLayoutTab', type, beforeFieldUid);\n\n        let fieldData = this.getFieldByType(type);\n        fieldData.field.type = type;\n\n        if (this.dragOrigin === this.DragOrigins.sourceField) {\n            fieldData.field.uid = Craft.uuid()\n        }\n\n        if (this.dragOrigin === this.DragOrigins.layoutField) {\n\n        }\n\n        let fieldUid = fieldData.field.uid;\n\n        // console.log(fieldData);\n\n        // this.fields.push(fieldData.field);\n        // this.uiSettings.push(fieldData.uiSettings);\n\n        let tabIndex = this.getTabIndexByTabUid(this.selectedTabUid);\n        let layoutElement = this.addLayoutElementToTab(fieldUid, fieldData.field, fieldData.uiSettings);\n        this.tabs[tabIndex].elements.push(layoutElement);\n\n        if (beforeFieldUid) {\n            this.updateFieldPosition(fieldUid, beforeFieldUid);\n        }\n    },\n\n    addLayoutElementToTab(fieldUid, field, uiSettings) {\n        return {\n            type: 'BarrelStrength\\\\Sprout\\\\forms\\\\submissions\\\\CustomFormField',\n            required: false,\n            width: 100,\n            uid: Craft.uuid(),\n            userCondition: null,\n            elementCondition: null,\n            fieldUid: fieldUid,\n            field: field,\n            uiSettings: uiSettings,\n        };\n    },\n\n    // scrollFieldLayout(stepY) {\n    //   let scrollY = document.documentElement.scrollTop || document.body.scrollTop;\n    //   window.scrollTo(0, (scrollY + stepY));\n    //\n    //   if (this.scrollActive) {\n    //     setTimeout(function() {\n    //       scroll(0, stepY);\n    //     }, 20);\n    //   }\n    // },\n\n    isBefore(element1, element2) {\n        if (element2.parentNode === element1.parentNode) {\n            for (let currentElement = element1.previousSibling; currentElement && currentElement.nodeType !== 9; currentElement = currentElement.previousSibling) {\n                if (currentElement === element2) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    },\n\n    // Field Stuff\n\n    editFormTab(tab) {\n\n        let self = this;\n\n        this.editTabUid = tab.uid;\n\n        Craft.sendActionRequest('POST', 'sprout-module-forms/forms/get-form-tab-settings-html', {\n            data: {\n                formId: this.formId,\n                tab: tab,\n            },\n        }).then((response) => {\n\n            const $body = $('<div/>', {class: 'fld-element-settings-body'});\n            const $fields = $('<div/>', {class: 'fields'}).appendTo($body);\n            const $footer = $('<div/>', {class: 'fld-element-settings-footer'});\n\n            const $removeBtn = Craft.ui.createButton({\n                class: 'icon',\n                attr: {\n                    'data-icon': 'trash',\n                },\n                label: Craft.t('app', 'Remove'),\n                spinner: true,\n            });\n\n            $removeBtn.attr('data-icon', 'trash');\n\n            // Copied from Craft's FieldLayoutDesigner.js\n            const $cancelBtn = Craft.ui.createButton({\n                data: {\n                    trashed: true,\n                },\n                label: Craft.t('app', 'Close'),\n                spinner: true,\n            });\n\n            const $applyButton = Craft.ui.createSubmitButton({\n                class: 'secondary',\n                label: Craft.t('app', 'Apply'),\n                spinner: true,\n            });\n\n            $removeBtn.appendTo($footer);\n            $('<div/>', {class: 'flex-grow'}).appendTo($footer);\n            $cancelBtn.appendTo($footer);\n            $applyButton.appendTo($footer);\n\n            let settingsHtml = self.swapPlaceholders(response.data.settingsHtml, response.data.tabUid);\n\n            $(settingsHtml).appendTo($fields);\n\n            const $contents = $body.add($footer);\n\n            // Make sure condition builder js is only added once\n            $('#sprout-tab-modal').remove();\n\n            const slideout = new Craft.Slideout($contents, {\n                containerElement: 'form',\n                containerAttributes: {\n                    method: 'post',\n                    action: '',\n                    class: 'fld-element-settings slideout',\n                    id: 'sprout-tab-modal',\n                },\n            });\n\n            const $form = slideout.$container;\n\n            let conditionBuilderJs = self.swapPlaceholders(response.data.conditionBuilderJs, response.data.tabUid);\n            Craft.appendBodyHtml(conditionBuilderJs);\n\n            $form.on('submit', function(event) {\n                event.preventDefault();\n\n                let formData = new FormData($form[0]);\n\n                Craft.sendActionRequest('POST', 'sprout-module-forms/forms/get-form-tab-object', {\n                    data: formData,\n                }).then((response) => {\n                    self.updateTabSettings(self.editTabUid, {\n                        name: response.data.name,\n                        userCondition: response.data.userCondition,\n                        elementCondition: response.data.elementCondition,\n                    });\n                });\n\n                slideout.close();\n            });\n\n            $removeBtn.on('click', () => {\n                // console.log(self.editTabUid);\n                slideout.close();\n                self.editFieldUid = null;\n            });\n\n            $cancelBtn.on('click', () => {\n                slideout.close();\n                self.editFieldUid = null;\n            });\n\n        }).catch(() => {\n            console.log('No form data found.');\n        });\n\n    },\n\n    // The js output by the condition builder\n    // \"<script>\n    // const conditionBuilderJs = \"<script>Garnish.requestAnimationFrame(() => {\n    //   const $button = $('#sources-__SOURCE_KEY__-condition-type-btn');\n    //   $button.menubtn().data('menubtn').on('optionSelect', event => {\n    //     const $option = $(event.option);\n    //     $button.text($option.text()).removeClass('add');\n    // // Don\\'t use data(\\'value\\') here because it could result in an object if data-value is JSON\n    //     const $input = $('#sources-__SOURCE_KEY__-condition-type-input').val($option.attr('data-value'));\n    //     htmx.trigger($input[0], 'change');\n    //   });\n    // });\n    // htmx.process(htmx.find('#__ID__'));\n    // htmx.trigger(htmx.find('#__ID__'), 'htmx:load');\n    // </script>\";\n    swapPlaceholders(str, sourceKey) {\n        const defaultId = `condition${Math.floor(Math.random() * 1000000)}`;\n\n        return str\n            .replace(/__ID__/g, defaultId)\n            .replace(/__SOURCE_KEY__(?=-)/g, Craft.formatInputId('\"' + sourceKey + '\"'))\n            .replace(/__SOURCE_KEY__/g, sourceKey);\n    },\n\n    editFormField(layoutElement) {\n\n        let self = this;\n\n        Craft.sendActionRequest('POST', 'sprout-module-forms/forms/get-form-field-settings-html', {\n            data: {\n                formId: this.formId,\n                layoutElement: layoutElement,\n            },\n        }).then((response) => {\n\n            const $body = $('<div/>', {class: 'fld-element-settings-body'});\n            const $fields = $('<div/>', {class: 'fields'}).appendTo($body);\n            const $footer = $('<div/>', {class: 'fld-element-settings-footer'});\n\n            const $removeBtn = Craft.ui.createButton({\n                class: 'icon',\n                attr: {\n                    'data-icon': 'trash',\n                },\n                label: Craft.t('app', 'Remove'),\n                spinner: true,\n            });\n\n            $removeBtn.attr('data-icon', 'trash');\n\n            // Copied from Craft's FieldLayoutDesigner.js\n            const $cancelBtn = Craft.ui.createButton({\n                data: {\n                    trashed: true,\n                },\n                label: Craft.t('app', 'Close'),\n                spinner: true,\n            });\n\n            const $applyButton = Craft.ui.createSubmitButton({\n                class: 'secondary',\n                label: Craft.t('app', 'Apply'),\n                spinner: true,\n            });\n\n            $removeBtn.appendTo($footer);\n            $('<div/>', {class: 'flex-grow'}).appendTo($footer);\n            $cancelBtn.appendTo($footer);\n            $applyButton.appendTo($footer);\n\n            let settingsHtml = self.swapPlaceholders(response.data.settingsHtml, response.data.fieldUid);\n\n            $(response.data.requiredSettingsHtml).appendTo($fields);\n            $(settingsHtml).appendTo($fields);\n            $(response.data.additionalSettingsHtml).appendTo($fields);\n\n            const $contents = $body.add($footer);\n\n            // Make sure condition builder js is only added once\n            $('#sprout-field-modal').remove();\n\n            const slideout = new Craft.Slideout($contents, {\n                containerElement: 'form',\n                containerAttributes: {\n                    method: 'post',\n                    action: '',\n                    class: 'fld-element-settings slideout',\n                    id: 'sprout-field-modal',\n                },\n            });\n\n            Craft.initUiElements($body);\n\n            let conditionBuilderJs = self.swapPlaceholders(response.data.conditionBuilderJs, response.data.fieldUid);\n            Craft.appendBodyHtml(conditionBuilderJs);\n\n            $form.on('submit', function(event) {\n                event.preventDefault();\n\n                let formData = new FormData($form[0]);\n                // let fieldSettings = JSON.stringify(Object.fromEntries(formData));\n                // console.log(fieldSettings);\n\n                Craft.sendActionRequest('POST', 'sprout-module-forms/forms/get-form-field-object', {\n                    data: formData,\n                }).then((response) => {\n\n                    // self.updateTabSettings(self.editTabUid, {\n                    //     name: response.data.name,\n                    //     userCondition: response.data.userCondition,\n                    //     elementCondition: response.data.elementCondition,\n                    // });\n                    //\n                    self.updateFieldSettings(self.editFieldUid, JSON.parse(response.data.fieldSettings));\n                });\n\n                slideout.close();\n            });\n\n\n            $removeBtn.on('click', () => {\n                // console.log(self.editFieldUid);\n                slideout.close();\n                self.editFieldUid = null;\n            });\n\n            $cancelBtn.on('click', () => {\n                slideout.close();\n                self.editFieldUid = null;\n            });\n\n        }).catch((error) => {\n            console.log('No form field data found.');\n        });\n    },\n});\n","export const FormField = (element) => ({\n\n    element: element,\n    dragHover: false,\n\n    init() {\n\n    },\n\n    // exampleHtml() {\n    //   // let fieldData = window.formBuilder.getFieldByType(this.field.type);\n    //\n    //   let editText = Craft.t('sprout-module-forms', 'Edit');\n    //\n    //   return '<div ' +\n    //     'class=\"layout-field\"\\n' +\n    //     'draggable=\"true\"\\n' +\n    //     'x-on:dragstart=\"handleDragStart\"\\n' +\n    //     'x-on:dblclick=\"editFormField\"\\n' +\n    //     'x-bind:data-type=\"field.type\"' +\n    //     '>' +\n    //     '<div class=\"layout-field-header\">' +\n    //     '<h2 x-bind:class=\"field.required\" x-text=\"field.name\"></h2>' +\n    //     '<code class=\"light\" x-text=\"field.handle\"></code>' +\n    //     '<p x-show=\"field.instructions\" x-text=\"field.instructions\"></p>' +\n    //     '</div>' +\n    //     '<div class=\"body\" x-html=\"field.exampleInputHtml\"></div>' +\n    //     '<div class=\"layout-field-overlay\">' +\n    //     '<div x-on:click=\"editFormField\" class=\"edit-field-button\">'+editText+'</div>' +\n    //     '</div>' +\n    //     '</div>';\n    // },\n\n    // @todo - somehow outputting this collapses padding to left of main body area\n    sourceHtml() {\n        return '<div\\n' +\n            'class=\"source-field\"\\n' +\n            'draggable=\"true\"\\n' +\n            'x-bind:class=\"[dragHover ? \\'drag-hover\\' : \\'\\', element.field.sortOrder % 2 == 0 ? \\'even\\' : \\'odd\\']\"\\n' +\n            'x-on:mouseover=\"dragHover = true\"\\n' +\n            'x-on:mouseleave=\"dragHover = false\"\\n' +\n            'x-on:dragstart.self=\"dragStartSourceField\"\\n' +\n            'x-on:dragend.self=\"dragEndSourceField\"\\n' +\n            'x-bind:data-type=\"element.field.type\"' +\n            '>' +\n            '<h3>' +\n            '<span x-html=\"element.uiSettings.icon\" class=\"sproutforms-icon\"></span>' +\n            '<span x-text=\"element.field.name\" x-bind:data-handle=\"element.field.name\" class=\"sproutforms-sourcefield-name\"></span>' +\n            '</h3>' +\n            '</div>';\n    },\n});\n","import Alpine from 'alpinejs';\nimport {FormBuilder} from './FormBuilder';\n// import {FormTab} from './FormTab';\nimport {FormField} from './FormField';\n\nwindow.Alpine = Alpine;\n\nAlpine.data('FormBuilder', FormBuilder);\n// Alpine.data('FormTab', FormTab);\nAlpine.data('FormField', FormField);\n\nAlpine.start();\n","/*\n * @link https://sprout.barrelstrengthdesign.com\n * @copyright Copyright (c) Barrel Strength Design LLC\n * @license https://craftcms.github.io/license\n */\n\n/* global Craft */\n/* global Garnish */\n\nif (typeof Craft.SproutForms === typeof undefined) {\n    Craft.SproutForms = {};\n}\n\n(function($) {\n    Craft.SproutForms.FormSettings = Garnish.Base.extend({\n\n        options: null,\n        modal: null,\n        $lightswitches: null,\n\n        /**\n         * The constructor.\n         */\n        init: function() {\n            // init method\n            this.initButtons();\n        },\n\n        /**\n         * Adds edit buttons to existing integrations.\n         */\n        initButtons: function() {\n            const that = this;\n\n            // Add listeners to all the items that start with sproutform-field-\n            $('a[id^=\\'sproutform-integration\\']').each(function(i, el) {\n                const integrationId = $(el).data('integrationid');\n\n                if (integrationId) {\n                    that.addListener($('#sproutform-integration-' + integrationId), 'activate', 'editIntegration');\n                }\n            });\n\n            this.$lightswitches = $('.sproutforms-integration-row .lightswitch');\n\n            this.addListener(this.$lightswitches, 'click', 'onEnableIntegration');\n\n            this.modal = Craft.SproutForms.IntegrationModal.getInstance();\n\n            this.modal.on('saveIntegration', $.proxy(function(e) {\n                const integration = e.integration;\n                // Let's update the name if the integration is updated\n                this.resetIntegration(integration);\n            }, this));\n\n            this.addListener($('#integrationsOptions'), 'change', 'createDefaultIntegration');\n        },\n\n        onEnableIntegration: function(ev) {\n            const lightswitch = ev.currentTarget;\n            const integrationId = lightswitch.id;\n            let enabled = $(lightswitch).attr('aria-checked');\n            enabled = enabled === 'true' ? 1 : 0;\n            const formId = $('#formId').val();\n\n            const data = {integrationId: integrationId, enabled: enabled, formId: formId};\n\n            Craft.postActionRequest('sprout-module-forms/form-integrations/enable-integration', data, $.proxy(function(response, textStatus) {\n                if (textStatus === 'success' && response.success) {\n                    Craft.cp.displayNotice(Craft.t('sprout', 'Integration updated.'));\n                } else {\n                    Craft.cp.displayError(Craft.t('sprout', 'Unable to update integration'));\n                }\n            }, this));\n\n        },\n\n        /**\n         * Renames | update icon |\n         * of an existing integration after edit it\n         *\n         * @param integration\n         */\n        resetIntegration: function(integration) {\n            const $integrationDiv = $('#sproutform-integration-' + integration.id);\n\n            const $container = $('#integration-enabled-' + integration.id);\n\n            const currentValue = integration.enabled === '1' ? true : false;\n            const settingsValue = $container.attr('aria-checked') === 'true' ? true : false;\n            if (currentValue !== settingsValue) {\n                $container.attr('aria-checked', '' + currentValue);\n                if (currentValue) {\n                    $container.addClass('on');\n                } else {\n                    $container.removeClass('on');\n                }\n            }\n            $integrationDiv.html(integration.name);\n        },\n\n        createDefaultIntegration: function(type) {\n\n            const that = this;\n            const integrationTableBody = $('#sproutforms-integrations-table tbody');\n            const currentIntegration = $('#integrationsOptions').val();\n            const formId = $('#formId').val();\n\n            if (currentIntegration === '') {\n                return;\n            }\n\n            const data = {\n                type: currentIntegration,\n                formId: formId,\n                sendRule: '*',\n            };\n\n            Craft.postActionRequest('sprout-module-forms/form-integrations/save-integration', data, $.proxy(function(response, textStatus) {\n                if (textStatus === 'success') {\n                    const integration = response.integration;\n\n                    integrationTableBody.append('<tr class=\"field sproutforms-integration-row\" id =\"sproutforms-integration-row-' + integration.id + '\">' +\n                        '<td class=\"heading\">' +\n                        '<a href=\"#\" id =\"sproutform-integration-' + integration.id + '\" data-integrationid=\"' + integration.id + '\">' + integration.name + '</a>' +\n                        '</td>' +\n                        '<td>' +\n                        '<div class=\"lightswitch small\" tabindex=\"0\" data-value=\"1\" role=\"checkbox\" aria-checked=\"false\" id =\"integration-enabled-' + integration.id + '\">' +\n                        '<div class=\"lightswitch-container\">' +\n                        '<div class=\"handle\"></div>' +\n                        '</div>' +\n                        '<input type=\"hidden\" name=\"\" value=\"\">' +\n                        '</div>' +\n                        '</td>' +\n                        '</tr>');\n\n                    that.addListener($('#sproutform-integration-' + integration.id), 'activate', 'editIntegration');\n\n                    $('#integrationsOptions').val('');\n                    const $container = $('#integration-enabled-' + integration.id);\n                    $container.lightswitch();\n                    that.addListener($container, 'click', 'onEnableIntegration');\n                } else {\n                    // something went wrong\n                }\n            }, this));\n\n        },\n\n        editIntegration: function(currentOption) {\n            const option = currentOption.currentTarget;\n\n            const integrationId = $(option).data('integrationid');\n            // Make our field available to our parent function\n            //this.$field = $(option);\n            this.base($(option));\n\n            this.modal.editIntegration(integrationId);\n        },\n\n    });\n\n})(jQuery);\n","/*\n * @link https://sprout.barrelstrengthdesign.com\n * @copyright Copyright (c) Barrel Strength Design LLC\n * @license https://craftcms.github.io/license\n */\n\n/* global Craft */\n\nclass SproutFormsIntegration {\n\n    constructor(settings) {\n        const self = this;\n\n        this.integrationType = typeof settings.integrationType !== 'undefined'\n            ? settings.integrationType\n            : '';\n\n        // Make the sourceFormField read only\n        this.disableOptions();\n\n        // Init all empty field selects\n        this.updateAllFieldSelects();\n\n        this.updateTargetFieldsOnChange = typeof settings.updateTargetFieldsOnChange !== 'undefined'\n            ? settings.updateTargetFieldsOnChange\n            : [];\n\n        this.updateTargetFieldsOnChange.forEach(function(elementId) {\n            // Register an onChange event for all Element IDs identified by the Integration\n            $(elementId).change(function() {\n                self.updateAllFieldSelects();\n            });\n        });\n    }\n\n    disableOptions() {\n        const self = this;\n        const integrationId = $('#integrationId').val();\n\n        const data = {\n            'integrationId': integrationId,\n        };\n\n        Craft.postActionRequest('sprout-module-forms/form-integrations/get-source-form-fields', data, $.proxy(function(response, textStatus) {\n            const statusSuccess = (textStatus === 'success');\n            if (statusSuccess && response.success) {\n                const rows = response.sourceFormFields;\n                $('tbody .formField').each(function(index) {\n                    const td = $(this);\n                    td.empty();\n                    const title = rows[index]['label'];\n                    const handle = rows[index]['value'];\n                    td.append('<div style=\"display:none;\"><select readonly name=\"settings[' + self.integrationType + '][fieldMapping][' + index + '][sourceFormField]\"><option selected value=\"' + handle + '\">' + title + '</option></select></div><div style=\"padding: 7px 10px;font-size: 12px;color:#8f98a3;\">' + title + ' <span class=\"code\">(' + handle + ')</span></div>');\n                });\n            } else {\n                Craft.cp.displayError(Craft.t('sprout', 'Unable to get the Form fields'));\n            }\n        }, this));\n\n        return null;\n    }\n\n    updateAllFieldSelects() {\n        const integrationIdBase = this.integrationType.replace(/\\\\/g, '-');\n        const mappingTableRows = 'table#settings-' + integrationIdBase + '-fieldMapping tr';\n\n        $(mappingTableRows).find('td:eq(2),th:eq(2)').remove();\n        $(mappingTableRows).find('td:eq(0),th:eq(0)').css('width', '50%');\n        $(mappingTableRows).find('td:eq(1),th:eq(1)').css('width', '50%');\n\n        const $currentRows = this.getCurrentRows('tbody .targetFields');\n\n        // Hand off all our current Form data so the Integration can use it if needed\n        const data = $('#integrationId').closest('form').serialize();\n\n        const self = this;\n\n        Craft.postActionRequest('sprout-module-forms/form-integrations/get-target-integration-fields', data, $.proxy(function(response, textStatus) {\n            const statusSuccess = (textStatus === 'success');\n\n            if (statusSuccess && response.success) {\n                const rows = response.targetIntegrationFields;\n\n                if (rows.length === 0) {\n                    return false;\n                }\n\n                $currentRows.each(function(index) {\n                    const $select = $(this).find('select');\n                    const fields = rows[index];\n\n                    self.appendFieldsToSelect($select, fields);\n                });\n            } else {\n                Craft.cp.displayError(Craft.t('sprout', 'Unable to get the Form fields'));\n            }\n        }, this));\n    }\n\n    getCurrentRows(className = null) {\n        if (className === null) {\n            className = 'tbody .formField';\n        }\n        return $(className);\n    }\n\n    appendFieldsToSelect($select, fields) {\n        $select.empty();\n\n        let dropdown = '';\n        let closeOptgroup = false;\n        $select.append('<option value=\"\">' + Craft.t('sprout', 'None') + '</option>');\n\n        for (let i = 0; i < fields.length; i++) {\n            const field = fields[i];\n            let selectedCode = '';\n            const lastItem = i === (fields.length - 1);\n\n            if (!('optgroup' in field)) {\n                if ('selected' in field) {\n                    selectedCode = 'selected';\n                }\n                dropdown += '<option ' + selectedCode + ' value=\"' + field['value'] + '\">' + field['label'] + '</option>';\n            }\n\n            if (('optgroup' in field && closeOptgroup) || (lastItem && closeOptgroup)) {\n                dropdown += '</optgroup>';\n                closeOptgroup = false;\n            }\n\n            if ('optgroup' in field) {\n                dropdown += '<optgroup label=\"' + field['optgroup'] + '\">';\n                closeOptgroup = true;\n            }\n        }\n\n        $select.append(dropdown);\n    }\n}\n\nwindow.SproutFormsIntegration = SproutFormsIntegration;\n","/*\n * @link https://sprout.barrelstrengthdesign.com\n * @copyright Copyright (c) Barrel Strength Design LLC\n * @license https://craftcms.github.io/license\n */\n\nif (typeof Craft.SproutForms === typeof undefined) {\n    Craft.SproutForms = {};\n}\n\n(function($) {\n    let MutationObserver = window.MutationObserver || window.WebKitMutationObserver;\n\n    // If mutation observer is not supported, create a harness for it for graceful degradation.\n    // Older browsers could be supported through the DOMNodeInserted event, but that can be saved for another day...\n    if (!MutationObserver) {\n        MutationObserver = function() {\n        };\n        MutationObserver.prototype.observe = function() {\n        };\n        MutationObserver.prototype.disconnect = function() {\n        };\n    }\n\n    /**\n     * SproutForms.IntegrationModal class\n     * Handles the modal window for editing integrations.\n     */\n    Craft.SproutForms.IntegrationModal = Garnish.Modal.extend({\n\n            $body: null,\n            $content: null,\n            $main: null,\n            $footer: null,\n            $leftButtons: null,\n            $rightButtons: null,\n            $saveBtn: null,\n            $cancelBtn: null,\n            $deleteBtn: null,\n            $saveSpinner: null,\n            $deleteSpinner: null,\n            $loadSpinner: null,\n            addedDelete: false,\n\n            $html: null,\n            $js: null,\n            $css: null,\n            $currentHtml: null,\n            $currentJs: null,\n            $currentCss: null,\n\n            $observed: null,\n            observer: null,\n\n            templateLoaded: false,\n            executedJs: null,\n            loadedCss: null,\n\n            /**\n             * The constructor.\n             */\n            init: function(settings) {\n                this.base();\n                this.setSettings(settings, {\n                    resizable: true,\n                });\n\n                this.$currentHtml = $();\n                this.$currentJs = $();\n                this.$currentCss = $();\n                this.$observed = $();\n\n                this.executedJs = {};\n                this.loadedCss = {};\n\n                // Observe the DOM\n                this.observer = new MutationObserver($.proxy(function(mutations) {\n                    for (let i = 0; i < mutations.length; i++) {\n                        this.$observed = this.$observed.add(mutations[i].addedNodes);\n                    }\n                }, this));\n\n                const $container = $('<form class=\"modal sprout-field-modal\" style=\"display: none; opacity: 0;\">').appendTo(Garnish.$bod);\n\n                this.$body = $('<div class=\"body\">').appendTo($container);\n                this.$content = $('<div class=\"content\">').appendTo(this.$body);\n                this.$main = $('<div class=\"main\">').appendTo(this.$content);\n                this.$footer = $('<div class=\"footer\">').appendTo($container);\n                this.$loadSpinner = $('<div class=\"spinner big\">').appendTo($container);\n\n                this.$leftButtons = $('<div class=\"buttons left\">').appendTo(this.$footer);\n                this.$rightButtons = $('<div class=\"buttons right\">').appendTo(this.$footer);\n\n                this.$deleteSpinner = $('<div class=\"spinner hidden\">').appendTo(this.$leftButtons);\n\n                this.$deleteBtn = $('<div class=\"btn delete hidden\" role=\"button\">').text(Craft.t('sprout', 'Delete')).appendTo(this.$leftButtons);\n                this.$cancelBtn = $('<div class=\"btn disabled\" role=\"button\">').text(Craft.t('sprout', 'Cancel')).appendTo(this.$rightButtons);\n                this.$saveBtn = $('<div class=\"btn submit disabled\" role=\"button\">').text(Craft.t('sprout', 'Save')).appendTo(this.$rightButtons);\n                this.$saveSpinner = $('<div class=\"spinner hidden\">').appendTo(this.$rightButtons);\n\n                this.setContainer($container);\n\n                this.$loadSpinner.addClass('hidden');\n                const response = {\n                    html: '',\n                    js: '',\n                    css: '',\n                };\n                this.initTemplate(response);\n            },\n\n            /**\n             * Prepares the Integration settings template HTML, CSS and Javascript.\n             *\n             * @param template\n             */\n            initTemplate: function(template) {\n                const callback = $.proxy(function(e) {\n                    this.$html = e.$html;\n                    this.$js = e.$js;\n                    this.$css = e.$css;\n\n                    this.templateLoaded = true;\n                    this.initListeners();\n                    if (this.visible) {\n                        this.initSettings();\n                    }\n\n                    this.off('parseTemplate', callback);\n                }, this);\n\n                this.on('parseTemplate', callback);\n                this.parseTemplate(template);\n            },\n\n            /**\n             * Takes raw HTML, CSS and Javascript and parses it ready to be used in the DOM.\n             * It also loads any external resources if they are needed.\n             *\n             * @param template\n             */\n            parseTemplate: function(template) {\n                const that = this;\n                const $head = Garnish.$doc.find('head');\n\n                const $html = $(template.html);\n                const $js = $(template.js).filter('script');\n                const $css = $(template.css).filter('style, link');\n\n                // Ensure that external stylesheets are loaded asynchronously\n                const $cssFiles = $css.filter('link').prop('async', true);\n                const $cssInline = $css.filter('style');\n\n                $cssFiles.each(function() {\n                    const $this = $(this);\n                    const src = $this.prop('href');\n\n                    if (!that.loadedCss.hasOwnProperty(src)) {\n                        $head.append($this);\n                        that.loadedCss[src] = $this;\n                    }\n                });\n\n                // Load external Javascript files asynchronously, and remove them from being executed again.\n                // This assumes that external Javascript files are simply library files, that don't directly and\n                // instantly execute code that modifies the DOM. Library files can be loaded and executed once and\n                // reused later on.\n                // The Javascript tags that directly contain code are assumed to be context-dependent, so they are\n                // saved to be executed each time the modal is opened.\n                const $jsFiles = $js.filter('[src]');\n                const $jsInline = $js.filter(':not([src])');\n\n                const jsFiles = [];\n                $jsFiles.each(function() {\n                    const $this = $(this);\n                    const src = $this.prop('src');\n                    if (!that.executedJs.hasOwnProperty(src)) {\n                        jsFiles.push(src);\n                        that.executedJs[src] = true;\n                    }\n                });\n\n                const callback = function() {\n                    that.off('runExternalScripts', callback);\n                    that.trigger('parseTemplate', {\n                        target: this,\n                        $html: $html,\n                        $js: $jsInline,\n                        $css: $cssInline,\n                    });\n                };\n                // Fixes bug on Craft3 - Updates way to callback function\n                $.when(this.runExternalScripts(jsFiles)).then(callback());\n                //this.runExternalScripts(jsFiles);\n\n                this.$deleteBtn.removeClass('hidden');\n                this.$saveBtn.removeClass('disabled');\n                this.$cancelBtn.removeClass('disabled');\n            },\n\n            /**\n             * Runs external Javascript files\n             *\n             * @param files - An array of URL's (as strings) to Javascript files\n             */\n            runExternalScripts: function(files) {\n                let filesCount = files.length;\n\n                if (filesCount > 0) {\n                    for (let i = 0; i < files.length; i++) {\n                        const src = files[i];\n\n                        // Fixes Double-instantiating bug\n                        if ((src.indexOf('MatrixConfigurator') >= 0) ||\n                            (src.indexOf('TableFieldSettings.min.js') >= 0) ||\n                            (src.indexOf('quill.min.js') >= 0) ||\n                            (src.indexOf('sproutfields.js') >= 0) ||\n                            (src.indexOf('EditableTable.js') >= 0) ||\n                            (src.indexOf('initialize.js') >= 0)\n                        ) {\n                            $.getScript(src, $.proxy(function(data, status) {\n                                if (status === 'success') {\n                                    filesCount--;\n\n                                    if (filesCount === 0) {\n                                        this.trigger('runExternalScripts', {\n                                            target: this,\n                                        });\n                                    }\n                                } else {\n                                    Craft.cp.displayError(Craft.t('sprout', 'Could not load all resources.'));\n                                }\n                            }, this));\n                        }\n                    }\n                } else {\n                    this.trigger('runExternalScripts', {\n                        target: this,\n                    });\n                }\n            },\n\n            /**\n             * Binds all listeners so the quick integration buttons can start working.\n             */\n            initListeners: function() {\n                this.$deleteBtn.addClass('hidden');\n                this.$cancelBtn.addClass('disabled');\n                this.$saveBtn.addClass('disabled');\n\n                this.addListener(this.$cancelBtn, 'activate', 'closeModal');\n                this.addListener(this.$saveBtn, 'activate', 'saveIntegration');\n                if (!this.addedDelete) {\n                    this.addListener(this.$deleteBtn, 'click', 'deleteIntegration');\n                    this.addedDelete = true;\n                }\n\n                this.on('show', this.initSettings);\n                this.on('fadeOut', this.destroySettings);\n\n                this.enable();\n            },\n\n            /**\n             * Unbinds all listeners.\n             */\n            destroyListeners: function() {\n                this.$cancelBtn.addClass('disabled');\n                this.$saveBtn.addClass('disabled');\n\n                this.removeListener(this.$cancelBtn, 'activate');\n                this.removeListener(this.$saveBtn, 'activate');\n\n                this.off('show', this.initSettings);\n                this.off('fadeOut', this.destroySettings);\n\n                this.disable();\n            },\n\n            /**\n             * Initialises the HTML, CSS and Javascript for the modal window.\n             */\n            initSettings: function(e) {\n                const that = e && e.target ? e.target : this;\n\n                // If the template files are not loaded yet, just cancel initialisation of the settings.\n                if (!that.templateLoaded) {\n                    return;\n                }\n\n                that.$currentHtml = e && e.$html ? e.$html : that.$html.clone();\n                that.$currentJs = e && e.$js ? e.$js : that.$js.clone();\n                that.$currentCss = e && e.$css ? e.$css : that.$css.clone();\n\n                // Save any new nodes that are added to the body during initialisation, so they can be safely removed later.\n                that.$observed = $();\n                that.observer.observe(Garnish.$bod[0], {childList: true, subtree: false});\n\n                that.$main.append(that.$currentHtml);\n                Garnish.$bod.append(that.$currentJs);\n\n                Craft.initUiElements();\n\n                // Rerun the external scripts as some field types may need to make DOM changes in their external files.\n                // This means that libraries are being initialized multiple times, but hopefully they're smart enough to\n                // deal with that. So far, no issues.\n                const callback = function() {\n                    that.off('runExternalScripts', callback);\n\n                    // Stop observing after a healthy timeout to ensure all mutations are captured.\n                    setTimeout(function() {\n                        that.observer.disconnect();\n                    }, 1);\n                };\n                $.when(that.runExternalScripts(Object.keys(that.executedJs))).then(callback());\n                //that.on('runExternalScripts', callback);\n                //that.runExternalScripts(Object.keys(that.executedJs));\n            },\n\n            /**\n             * Event handler for when the modal window finishes fading out after hiding.\n             * Clears out all events and elements of the modal.\n             */\n            destroySettings: function(e) {\n                const that = e && e.target ? e.target : this;\n\n                that.$currentHtml.remove();\n                that.$currentJs.remove();\n                that.$currentCss.remove();\n                that.$observed.remove();\n            },\n\n            /**\n             * Event handler for the Close button.\n             * Hides the modal window from view.\n             */\n            closeModal: function() {\n                this.hide();\n            },\n\n            /**\n             * Event handler for the save button.\n             * Saves the Integration settings to the database.\n             *\n             * @param e\n             */\n            saveIntegration: function(e) {\n                if (e) {\n                    e.preventDefault();\n                }\n\n                if (this.$saveBtn.hasClass('disabled') || !this.$saveSpinner.hasClass('hidden')) {\n                    return;\n                }\n\n                this.destroyListeners();\n\n                this.$saveSpinner.removeClass('hidden');\n                const data = this.$container.serialize();\n\n                const inputId = this.$container.find('input[name=\"integrationId\"]');\n                const id = inputId.length ? inputId.val() : false;\n\n                Craft.postActionRequest('sprout-module-forms/form-integrations/save-integration', data, $.proxy(function(response, textStatus) {\n                    this.$saveSpinner.addClass('hidden');\n\n                    const statusSuccess = (textStatus === 'success');\n\n                    if (statusSuccess && response.success) {\n                        this.initListeners();\n\n                        this.trigger('saveIntegration', {\n                            target: this,\n                            integration: response.integration,\n                        });\n\n                        Craft.cp.displayNotice(Craft.t('sprout', '\\'{name}\\' integration saved.', {name: response.integration.name}));\n\n                        this.hide();\n                    } else if (statusSuccess && response.template) {\n                        if (this.visible) {\n                            const callback = $.proxy(function(e) {\n                                this.initListeners();\n                                this.destroySettings();\n                                this.initSettings(e);\n                                this.off('parseTemplate', callback);\n                            }, this);\n\n                            this.on('parseTemplate', callback);\n                            this.parseTemplate(response.template);\n\n                            Garnish.shake(this.$container);\n                        } else {\n                            this.initListeners();\n                        }\n                    } else {\n                        this.initListeners();\n\n                        Craft.cp.displayError(Craft.t('sprout', 'An unknown error occurred.'));\n                    }\n                }, this));\n            },\n\n            /**\n             *\n             * @param id\n             */\n            editIntegration: function(id) {\n                this.destroyListeners();\n                this.show();\n                this.initListeners();\n\n                this.$loadSpinner.removeClass('hidden');\n\n                const formId = $('#formId').val();\n                const data = {\n                    'integrationId': id,\n                    'formId': formId,\n                };\n\n                Craft.postActionRequest('sprout-module-forms/form-integrations/edit-integration', data, $.proxy(function(response, textStatus) {\n                    this.$loadSpinner.addClass('hidden');\n\n                    const statusSuccess = (textStatus === 'success');\n\n                    if (statusSuccess && response.success) {\n                        const callback = $.proxy(function(e) {\n                            this.destroySettings();\n                            this.initSettings(e);\n                            this.off('parseTemplate', callback);\n                        }, this);\n\n                        this.on('parseTemplate', callback);\n                        this.parseTemplate(response.template);\n                    } else if (statusSuccess && response.error) {\n                        Craft.cp.displayError(response.error);\n\n                        this.hide();\n                    } else {\n                        Craft.cp.displayError(Craft.t('sprout', 'An unknown error occurred. '));\n\n                        this.hide();\n                    }\n                }, this));\n            },\n\n            deleteIntegration: function(e) {\n                e.preventDefault();\n                const userResponse = this.confirmDeleteIntegration();\n\n                if (userResponse) {\n                    this.destroyListeners();\n\n                    const data = this.$container.serialize();\n\n                    const integrationId = $(this.$container).find('input[name=\"integrationId\"]').val();\n\n                    Craft.postActionRequest('sprout-module-forms', data, $.proxy(function(response, textStatus) {\n                        const statusSuccess = (textStatus === 'success');\n\n                        if (statusSuccess && response.success) {\n\n                            Craft.cp.displayNotice(Craft.t('sprout', 'Integration deleted.'));\n\n                            $('#sproutforms-integration-row-' + integrationId).remove();\n\n                            this.initListeners();\n                            this.hide();\n                        } else {\n                            Craft.cp.displayError(Craft.t('sprout', 'Unable to delete integration.'));\n\n                            this.hide();\n                        }\n                    }, this));\n                }\n            },\n\n            confirmDeleteIntegration: function() {\n                return confirm('Are you sure you want to delete this integration and all of it\\'s settings?');\n            },\n\n            /**\n             * Prevents the modal from closing if it's disabled.\n             * This fixes issues if the modal is closed when saving/deleting integrations.\n             */\n            hide: function() {\n                if (!this._disabled) {\n                    this.base();\n                }\n            },\n\n            /**\n             * Removes everything to do with the modal form the DOM.\n             */\n            destroy: function() {\n                this.base.destroy();\n\n                this.destroyListeners();\n                this.destroySettings();\n\n                this.$shade.remove();\n                this.$container.remove();\n\n                this.trigger('destroy');\n            },\n        },\n        {\n            /**\n             * (Static) Singleton pattern.\n             *\n             * @returns IntegrationModal\n             */\n            getInstance: function() {\n                if (!this._instance) {\n                    this._instance = new Craft.SproutForms.IntegrationModal();\n                }\n\n                return this._instance;\n            },\n        });\n\n})(jQuery);\n"],"names":["$relationModal","$modal","data","response","sproutRelationBtn","event","FormBuilder","formId","self","sourceFields","field","tab","fieldLayout","fieldLayoutTabs","fieldLayoutFields","element","fieldData","uiSettings","fieldAttributes","e","originTabUid","targetTabUid","type","dropBeforeTargetFieldUid","value","handle","item","id","fieldUid","tabUid","tabIndex","index","fieldSettings","fieldIndex","targetField","beforeTabUid","beforeTabIndex","targetTab","targetTabIndex","originTabIndex","originTab","beforeFieldUid","beforeFieldIndex","layoutElement","element1","element2","currentElement","$body","$fields","$footer","$removeBtn","$cancelBtn","$applyButton","settingsHtml","$contents","slideout","$form","conditionBuilderJs","formData","str","sourceKey","defaultId","error","FormField","Alpine","$","that","el","integrationId","integration","ev","lightswitch","enabled","textStatus","$integrationDiv","$container","currentValue","settingsValue","integrationTableBody","currentIntegration","currentOption","option","SproutFormsIntegration","settings","elementId","rows","td","title","mappingTableRows","$currentRows","$select","fields","className","dropdown","closeOptgroup","i","selectedCode","lastItem","MutationObserver","mutations","template","callback","$head","$html","$js","$css","$cssFiles","$cssInline","$this","src","$jsFiles","$jsInline","jsFiles","files","filesCount","status","inputId","statusSuccess"],"mappings":"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"}