import"./addressField-c5a66b02.js";import"./emailField-b0a45f50.js";import"./phoneField-3f5ae47e.js";(function(o){o.fn.caret=function(e){var t=this[0],a=t.contentEditable==="true";if(arguments.length==0){if(window.getSelection){if(a){t.focus();var i=window.getSelection().getRangeAt(0),s=i.cloneRange();return s.selectNodeContents(t),s.setEnd(i.endContainer,i.endOffset),s.toString().length}return t.selectionStart}if(document.selection){if(t.focus(),a){var i=document.selection.createRange(),s=document.body.createTextRange();return s.moveToElementText(t),s.setEndPoint("EndToEnd",i),s.text.length}var e=0,n=t.createTextRange(),s=document.selection.createRange().duplicate(),l=s.getBookmark();for(n.moveToBookmark(l);n.moveStart("character",-1)!==0;)e++;return e}return t.selectionStart?t.selectionStart:0}if(e==-1&&(e=this[a?"text":"val"]().length),window.getSelection)a?(t.focus(),window.getSelection().collapse(t.firstChild,e)):t.setSelectionRange(e,e);else if(document.body.createTextRange)if(a){var n=document.body.createTextRange();n.moveToElementText(t),n.moveStart("character",e),n.collapse(!0),n.select()}else{var n=t.createTextRange();n.move("character",e),n.select()}return a||t.focus(),e}})(jQuery);class y{constructor(e){this.fieldHandle=e.fieldHandle,this.metaBadgeInfo=e.metaBadgeInfo,this.maxDescriptionLength=e.maxDescriptionLength,this.initMetadataFieldButtons(),this.addMetaBadgesToUi()}initMetadataFieldButtons(){let e=this,t="fields-"+this.fieldHandle+"-meta-details-tabs";this.metaDetailsTabs=document.querySelectorAll("#"+t+" div.btn");let a="fields-"+this.fieldHandle+"-meta-details-body";if(this.metaDetailsBodyContainers=document.querySelectorAll("#"+a+" div.matrixblock"),!(this.metaDetailsBodyContainers.length<1)){for(let i of this.metaDetailsTabs)i.addEventListener("click",function(s){let n=$(s.target);n.is("div")||(n=n.closest("div.btn"));let l=$("#fields-projectsMetadata-meta-details-tabs .active");if(n.is(l))return!0;let d=n.attr("data-type"),u="#fields-"+e.fieldHandle+"-meta-details-body .fields-"+d,f=document.querySelector(u);for(let r of e.metaDetailsTabs)r.classList.remove("active");for(let r of e.metaDetailsBodyContainers)r.style.display="none";$(f).show(),n.addClass("active")});$(this.metaDetailsBodyContainers[0]).show(),this.metaDetailsTabs[0].classList.add("active")}}addMetaBadgesToUi(){for(let e in this.metaBadgeInfo){this.metaBadgeInfo[e].type;let t=this.metaBadgeInfo[e].handle,a=this.metaBadgeInfo[e].badgeClass,i="#fields-"+t+"-label",s="#fields-"+t+"-field input";$(s),t==="title"&&(i="#title-label",$("#title")),$(i).find(".sprout-info").length===0&&$("div."+a).appendTo($(i)).removeClass("hidden")}}getCustomizationSettings(e){return $("input[name='fields["+this.fieldHandle+"][metadata]["+e+"]']")}appendMetaBadge(e,t){$(e).find(".sprout-info").length===0&&$(e).append(t).removeClass("hidden")}}class w{constructor(e){this.keywordsFieldId=e.keywordsFieldId,this.initKeywordsField()}initKeywordsField(){}}window.SproutMetaMetadataField=y;window.SproutMetaKeywordsField=w;typeof Craft.SproutMeta>"u"&&(Craft.SproutMeta={});Craft.SproutMeta.EditableTable=Garnish.Base.extend({initialized:!1,id:null,baseName:null,columns:null,sorter:null,biggestId:-1,$table:null,$tbody:null,$addRowBtn:null,init:function(o,e,t,a){this.id=o,this.baseName=e,this.columns=t,this.setSettings(a,Craft.SproutMeta.EditableTable.defaults),this.$table=$("#"+o),this.$tbody=this.$table.children("tbody"),this.sorter=new Craft.DataTableSorter(this.$table,{helperClass:"editabletablesorthelper",copyDraggeeInputValuesToHelper:!0}),this.isVisible()?this.initialize():this.addListener(Garnish.$win,"resize","initializeIfVisible")},isVisible:function(){return this.$table.height()>0},initialize:function(){if(this.initialized)return;this.initialized=!0,this.removeListener(Garnish.$win,"resize");const o=this.$tbody.children();for(let e=0;e<o.length;e++)new Craft.SproutMeta.EditableTable.Row(this,o[e]);this.$addRowBtn=this.$table.next(".buttons").children(".add"),this.addListener(this.$addRowBtn,"activate","addRow")},initializeIfVisible:function(){this.isVisible()&&this.initialize()},addRow:function(){const o=this.settings.rowIdPrefix+(this.biggestId+1),e=Craft.SproutMeta.EditableTable.getRowHtml(o,this.columns,this.baseName,{}),t=$(e).appendTo(this.$tbody);new Craft.SproutMeta.EditableTable.Row(this,t),this.sorter.addItems(t),t.find("input,textarea,select").first().focus(),this.settings.onAddRow(t)}},{textualColTypes:["singleline","multiline","number"],defaults:{rowIdPrefix:"",onAddRow:$.noop,onDeleteRow:$.noop},getRowHtml:function(o,e,t,a){let i='<tr data-id="'+o+'">';for(let s in e){const n=e[s],l=t+"["+o+"]["+s+"]",d=typeof a[s]<"u"?a[s]:"",u=Craft.inArray(n.type,Craft.SproutMeta.EditableTable.textualColTypes);switch(i+='<td class="'+(u?"textual":"")+" "+(typeof n.class<"u"?n.class:"")+'"'+(typeof n.width<"u"?' width="'+n.width+'"':"")+">",n.type){case"selectOther":{t.indexOf("ownership")>-1?i+='<div class="field sprout-selectother"><div class="select sprout-selectotherdropdown"><select onchange="setDefault(this)" name="'+l+'">':i+='<div class="field sprout-selectother"><div class="select sprout-selectotherdropdown"><select name="'+l+'">';let r=!1,p="disabled selected";for(let h in n.options){const c=n.options[h];if(typeof c.optgroup<"u")r?i+="</optgroup>":r=!0,i+='<optgroup label="'+c.optgroup+'">';else{const m=typeof c.label<"u"?c.label:c,g=typeof c.value<"u"?c.value:h,b=typeof c.disabled<"u"?c.disabled:!1;i+="<option "+p+' value="'+g+'"'+(g===d?" selected":"")+(b?" disabled":"")+">"+m+"</option>"}p=""}r&&(i+="</optgroup>"),i+="</select></div>",i+='<div class="texticon clearable sprout-selectothertext hidden"><input class="text fullwidth" type="text" name="'+l+'" value="" autocomplete="off"><div class="clear" title="Clear"></div></div>',i+="</div>";break}case"checkbox":{i+='<input type="hidden" name="'+l+'"><input type="checkbox" name="'+l+'" value="1"'+(d?" checked":"")+">";break}default:i+='<input class="text fullwidth" type="text" name="'+l+'" value="'+d+'">'}i+="</td>"}return i+='<td class="thin action"><a class="move icon" title="'+Craft.t("sprout","Reorder")+'"></a></td><td class="thin action"><a class="delete icon" title="'+Craft.t("sprout","Delete")+'"></a></td></tr>',i}});Craft.SproutMeta.EditableTable.Row=Garnish.Base.extend({table:null,id:null,niceTexts:null,$tr:null,$tds:null,$textareas:null,$deleteBtn:null,init:function(o,e){this.table=o,this.$tr=$(e),this.$tds=this.$tr.children();const t=parseInt(this.$tr.attr("data-id").substr(this.table.settings.rowIdPrefix.length));t>this.table.biggestId&&(this.table.biggestId=t),this.$textareas=$(),this.niceTexts=[];const a={};let i=0;for(let n in this.table.columns){let l=this.table.columns[n];if(Craft.inArray(l.type,Craft.SproutMeta.EditableTable.textualColTypes)){const d=$("textarea",this.$tds[i]);this.$textareas=this.$textareas.add(d),this.addListener(d,"focus","onTextareaFocus"),this.addListener(d,"mousedown","ignoreNextTextareaFocus"),this.niceTexts.push(new Garnish.NiceText(d,{onHeightChange:$.proxy(this,"onTextareaHeightChange")})),(l.type==="singleline"||l.type==="number")&&(this.addListener(d,"keypress",{type:l.type},"validateKeypress"),this.addListener(d,"textchange",{type:l.type},"validateValue")),a[n]=d}i++}this.initSproutFields(),this.onTextareaHeightChange();for(let n in this.table.columns){let l=this.table.columns[n];l.autopopulate&&typeof a[l.autopopulate]<"u"&&!a[n].val()&&new Craft.HandleGenerator(a[n],a[l.autopopulate])}const s=this.$tr.children().last().find(".delete");this.addListener(s,"click","deleteRow")},initSproutFields:function(){Craft.SproutFields.initFields(this.$tr)},onTextareaFocus:function(o){this.onTextareaHeightChange();const e=$(o.currentTarget);if(e.data("ignoreNextFocus")){e.data("ignoreNextFocus",!1);return}setTimeout(function(){const t=e.val();if(typeof e[0].setSelectionRange<"u"){const a=t.length*2;e[0].setSelectionRange(0,a)}else e.val(t)},0)},ignoreNextTextareaFocus:function(o){$.data(o.currentTarget,"ignoreNextFocus",!0)},validateKeypress:function(o){const e=o.keyCode?o.keyCode:o.charCode;!Garnish.isCtrlKeyPressed(o)&&(e===Garnish.RETURN_KEY||o.data.type==="number"&&!Craft.inArray(e,Craft.SproutMeta.EditableTable.Row.numericKeyCodes))&&o.preventDefault()},validateValue:function(o){let e;if(o.data.type==="number"){const t=o.currentTarget.value.match(/^\s*(-?[\d.]*)/);t!==null?e=t[1]:e=""}else e=o.currentTarget.value.replace(/[\r\n]/g,"");e!==o.currentTarget.value&&(o.currentTarget.value=e)},onTextareaHeightChange:function(){let o=-1;for(let t=0;t<this.niceTexts.length;t++)this.niceTexts[t].height>o&&(o=this.niceTexts[t].height);this.$textareas.css("min-height",o);const e=this.$textareas.first().parent().height();e>o&&this.$textareas.css("min-height",e)},deleteRow:function(){this.table.sorter.removeItems(this.$tr),this.$tr.remove(),this.table.settings.onDeleteRow(this.$tr)}},{numericKeyCodes:[9,8,37,38,39,40,45,91,46,190,48,49,50,51,52,53,54,55,56,57]});class C{constructor(e){let t=this;this.fieldHandle=e.fieldHandle,this.selectFieldId=e.selectFieldId;let a="#fields-"+this.fieldHandle+"-meta-details-body "+this.selectFieldId,i=document.querySelector(a);if(i!==null){let s=i.options[i.selectedIndex].value;this.currentContainerId=this.getTargetContainerId(s),this.currentContainer=document.getElementById(this.currentContainerId),this.currentContainer&&this.currentContainer.classList.remove("hidden"),i.addEventListener("change",function(n){t.toggleOpenGraphFieldContainer(n,t)})}}toggleOpenGraphFieldContainer(e,t){let a=e.target,i=a.options[a.selectedIndex].value,s=t.getTargetContainerId(i),n=document.getElementById(s);n&&n.classList.remove("hidden"),t.currentContainer&&t.currentContainer.classList.add("hidden"),t.currentContainerId=s,t.currentContainer=n}getTargetContainerId(e){return"#fields-"+e}}window.MetaDetailsToggle=C;class v{constructor(e){this.items=e.items,this.mainEntityValues=e.mainEntityValues,this.initLegacyCode(),this.initOtherLegacyCode()}initLegacyCode(){let e=this,t="",a=function(f,r){$.each(f,function(p,h){p>=r&&$(h).html(t)})},i=function(f,r){$.each(f,function(p,h){p>=r&&$(h).closest("div.organizationinfo-dropdown").addClass("hidden")})},s=function(f){f.closest("div.organizationinfo-dropdown").removeClass("hidden")},n=function(f,r){let p="",h="";$.each(r,function(c,m){h=c.replace(/([A-Z][^A-Z\b])/g," $1").trim(),p+='<option value="'+c+'">'+h+"</option>",m&&$.each(m,function(g,b){h="&nbsp;&nbsp;&nbsp;"+g.replace(/([A-Z][^A-Z\b])/g," $1").trim(),p+='<option value="'+g+'">'+h+"</option>"})}),f.append(p)},l=$(".mainentity-firstdropdown select"),d=$(".mainentity-seconddropdown select"),u="";l.on("change",function(){u=l.val(),a($(".organization-info :input"),1),i($(".organization-info :input"),1),!(typeof e.items[u]>"u"||u===""||e.items[u].length<=0)&&e.items[u][0]&&(s(d),n(d,e.items[u][0]))}),d.on("change",function(){d.val()})}initOtherLegacyCode(){let t=this.mainEntityValues;$(".mainentity-firstdropdown select").change(function(){this.value==="barrelstrength-sprout-schema-personschema"?$(".mainentity-seconddropdown select").addClass("hidden"):$(".mainentity-seconddropdown select").removeClass("hidden")}),t&&(t.hasOwnProperty("schemaTypeId")&&t.schemaTypeId&&$(".mainentity-firstdropdown select").val(t.schemaTypeId).change(),t.hasOwnProperty("schemaOverrideTypeId")&&t.schemaOverrideTypeId&&$(".mainentity-seconddropdown select").val(t.schemaOverrideTypeId).change())}}window.SproutMetaWebsiteIdentitySettings=v;class T{constructor(e){this.items=e.items,this.websiteIdentity=e.websiteIdentity,this.firstDropdownId=e.firstDropdownId,this.secondDropdownId=e.secondDropdownId,this.thirdDropdownId=e.thirdDropdownId,this.initInfoIcons(),this.initWebsiteIdentityField(),this.moreWebsiteIdentityStuff()}initInfoIcons(){document.querySelectorAll("[data-additional-info]").forEach(function(t){let a=t.dataset.additionalInfo;document.getElementById(a+"-label").appendChild(t),t.classList.toggle("hidden")})}initWebsiteIdentityField(){let e=this,t=$(this.firstDropdownId),a=$(this.secondDropdownId),i=$(this.thirdDropdownId),s="",n="";t.on("change",function(){s=t.val(),e.clearDropDown($("#organization :input"),1),e.disableDropDown($("#organization :input"),1),s!==""&&e.items[s].hasOwnProperty("children")&&(e.enableDropDown(a),e.generateOptions(a,e.items[s].children))}),a.on("change",function(){if(s=$("#main-entity-first-dropdown").val(),n=a.val(),e.clearDropDown($("#organization :input"),2),e.disableDropDown($("#organization :input"),2),n==="")return;let l=e.items[s].children;for(let d=0;d<l.length;d++)if(l[d].name===n){l[d].hasOwnProperty("children")&&(e.enableDropDown(i),e.generateOptions(i,l[d].children));break}})}moreWebsiteIdentityStuff(){let e=this.websiteIdentity;e&&(e.hasOwnProperty("organizationSubTypes")&&e.organizationSubTypes[0]&&$("#main-entity-first-dropdown").val(e.organizationSubTypes[0]).trigger("change"),e.hasOwnProperty("organizationSubTypes")&&e.organizationSubTypes[1]&&$("#main-entity-second-dropdown").val(e.organizationSubTypes[1]).trigger("change"),e.hasOwnProperty("organizationSubTypes")&&e.organizationSubTypes[2]&&$("#main-entity-third-dropdown").val(e.organizationSubTypes[2]).trigger("change")),$("#identityType").change(function(){this.value==="Person"?($(".person-info").removeClass("hidden"),$(".organization-info").addClass("hidden")):($(".person-info").addClass("hidden"),$(".organization-info").removeClass("hidden")),this.value==="Organization"?($(".organization-info").removeClass("hidden"),$(".person-info").addClass("hidden"),$("#main-entity-first-dropdown").val()==="LocalBusiness"&&$("#localbusiness").removeClass("hidden")):($(".organization-info").addClass("hidden"),$(".person-info").removeClass("hidden"))}),$("#main-entity-first-dropdown").change(function(){this.value==="LocalBusiness"?$("#localbusiness").removeClass("hidden"):$("#localbusiness").addClass("hidden")})}clearDropDown(e,t){let a='<option value="" selected="selected"></option>';$.each(e,function(i,s){i>=t&&$(s).html(a)})}disableDropDown(e,t){$.each(e,function(a,i){a>=t&&$(i).closest("div.organizationinfo-dropdown").addClass("hidden")})}enableDropDown(e){e.closest("div.organizationinfo-dropdown").removeClass("hidden")}generateOptions(e,t){let a="",i="";for(let s=0;s<t.length;s++)i=t[s].name.replace(/([A-Z][^A-Z\b])/g," $1").trim(),a+='<option value="'+t[s].name+'">'+i+"</option>";e.append(a)}}window.SproutMetaWebsiteIdentity=T;
//# sourceMappingURL=meta-98e944b7.js.map
