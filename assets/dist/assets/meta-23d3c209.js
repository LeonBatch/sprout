import{c as lt,g as dt}from"./_commonjsHelpers-725317a4.js";import"./addressField-c5a66b02.js";import"./emailField-b0a45f50.js";import"./phoneField-3f5ae47e.js";var et={exports:{}};(function(m,l){(function(d,c){m.exports=c()})(lt,function(){function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,i)}return s}function c(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?d(Object(s),!0).forEach(function(i){p(t,i,s[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(s,i))})}return t}function p(t,e,s){return(e=function(i){var a=function(n,o){if(typeof n!="object"||n===null)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var h=r.call(n,o||"default");if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(n)}(i,"string");return typeof a=="symbol"?a:String(a)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const v=(t,e,s,i)=>(t=""+t,e=""+e,i&&(t=t.trim(),e=e.trim()),s?t==e:t.toLowerCase()==e.toLowerCase()),w=(t,e)=>t&&Array.isArray(t)&&t.map(s=>T(s,e));function T(t,e){var s,i={};for(s in t)e.indexOf(s)<0&&(i[s]=t[s]);return i}function y(t){var e=document.createElement("div");return t.replace(/\&#?[0-9a-z]+;/gi,function(s){return e.innerHTML=s,e.innerText})}function E(t){return new DOMParser().parseFromString(t.trim(),"text/html").body.firstElementChild}function k(t,e){for(e=e||"previous";t=t[e+"Sibling"];)if(t.nodeType==3)return t}function S(t){return typeof t=="string"?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/`|'/g,"&#039;"):t}function M(t){var e=Object.prototype.toString.call(t).split(" ")[1].slice(0,-1);return t===Object(t)&&e!="Array"&&e!="Function"&&e!="RegExp"&&e!="HTMLUnknownElement"}function x(t,e,s){function i(a,n){for(var o in n)if(n.hasOwnProperty(o)){if(M(n[o])){M(a[o])?i(a[o],n[o]):a[o]=Object.assign({},n[o]);continue}if(Array.isArray(n[o])){a[o]=Object.assign([],n[o]);continue}a[o]=n[o]}}return t instanceof Object||(t={}),i(t,e),s&&i(t,s),t}function _(){const t=[],e={};for(let s of arguments)for(let i of s)M(i)?e[i.value]||(t.push(i),e[i.value]=1):t.includes(i)||t.push(i);return t}function B(t){return String.prototype.normalize?typeof t=="string"?t.normalize("NFD").replace(/[\u0300-\u036f]/g,""):void 0:t}var H=()=>/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent);function K(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16))}function q(t){return t&&t.classList&&t.classList.contains(this.settings.classNames.tag)}function Q(t,e){var s=window.getSelection();return e=e||s.getRangeAt(0),typeof t=="string"&&(t=document.createTextNode(t)),e&&(e.deleteContents(),e.insertNode(t)),t}function I(t,e,s){return t?(e&&(t.__tagifyTagData=s?e:x({},t.__tagifyTagData||{},e)),t.__tagifyTagData):(Tagify.logger.warn("tag element doesn't exist",{tagElm:t,data:e}),e)}function z(t){if(t&&t.parentNode){var e=t,s=window.getSelection(),i=s.getRangeAt(0);s.rangeCount&&(i.setStartAfter(e),i.collapse(!0),s.removeAllRanges(),s.addRange(i))}}function Y(t,e){t.forEach(s=>{if(I(s.previousSibling)||!s.previousSibling){var i=document.createTextNode("​");s.before(i),e&&z(i)}})}var J={delimiters:",",pattern:null,tagTextProp:"value",maxTags:1/0,callbacks:{},addTagOnBlur:!0,addTagOn:["blur","tab","enter"],onChangeAfterBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,userInput:!0,keepInvalidTags:!1,createInvalidTags:!0,mixTagsAllowedAfter:/,|\.|\:|\s/,mixTagsInterpolator:["[[","]]"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:()=>{},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:" "},autoComplete:{enabled:!0,rightKey:!1,tabKey:!1},classNames:{namespace:"tagify",mixMode:"tagify--mix",selectMode:"tagify--select",input:"tagify__input",focus:"tagify--focus",tagNoAnimation:"tagify--noAnim",tagInvalid:"tagify--invalid",tagNotAllowed:"tagify--notAllowed",scopeLoading:"tagify--loading",hasMaxTags:"tagify--hasMaxTags",hasNoTags:"tagify--noTags",empty:"tagify--empty",inputInvalid:"tagify__input--invalid",dropdown:"tagify__dropdown",dropdownWrapper:"tagify__dropdown__wrapper",dropdownHeader:"tagify__dropdown__header",dropdownFooter:"tagify__dropdown__footer",dropdownItem:"tagify__dropdown__item",dropdownItemActive:"tagify__dropdown__item--active",dropdownItemHidden:"tagify__dropdown__item--hidden",dropdownInital:"tagify__dropdown--initial",tag:"tagify__tag",tagText:"tagify__tag-text",tagX:"tagify__tag__removeBtn",tagLoading:"tagify__tag--loading",tagEditing:"tagify__tag--editable",tagFlash:"tagify__tag--flash",tagHide:"tagify__tag--hide"},dropdown:{classname:"",enabled:2,maxItems:10,searchKeys:["value","searchBy"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,includeSelectedTags:!1,escapeHTML:!0,highlightFirst:!0,closeOnSelect:!0,clearOnSelect:!0,position:"all",appendTarget:null},hooks:{beforeRemoveTag:()=>Promise.resolve(),beforePaste:()=>Promise.resolve(),suggestionClick:()=>Promise.resolve(),beforeKeyDown:()=>Promise.resolve()}},it={events:{binding(){let t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];var e=this.dropdown.events.callbacks,s=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this,null),onKeyDown:e.onKeyDown.bind(this),onMouseOver:e.onMouseOver.bind(this),onMouseLeave:e.onMouseLeave.bind(this),onClick:e.onClick.bind(this),onScroll:e.onScroll.bind(this)},i=t?"addEventListener":"removeEventListener";this.settings.dropdown.position!="manual"&&(document[i]("scroll",s.position,!0),window[i]("resize",s.position),window[i]("keydown",s.onKeyDown)),this.DOM.dropdown[i]("mouseover",s.onMouseOver),this.DOM.dropdown[i]("mouseleave",s.onMouseLeave),this.DOM.dropdown[i]("mousedown",s.onClick),this.DOM.dropdown.content[i]("scroll",s.onScroll)},callbacks:{onKeyDown(t){if(this.state.hasFocus&&!this.state.composing){var e=this.settings,s=this.DOM.dropdown.querySelector(e.classNames.dropdownItemActiveSelector),i=this.dropdown.getSuggestionDataByNode(s),a=e.mode=="mix";e.hooks.beforeKeyDown(t,{tagify:this}).then(n=>{switch(t.key){case"ArrowDown":case"ArrowUp":case"Down":case"Up":t.preventDefault();var o=this.dropdown.getAllSuggestionsRefs(),r=t.key=="ArrowUp"||t.key=="Up";s&&(s=this.dropdown.getNextOrPrevOption(s,!r)),s&&s.matches(e.classNames.dropdownItemSelector)||(s=o[r?o.length-1:0]),this.dropdown.highlightOption(s,!0);break;case"Escape":case"Esc":this.dropdown.hide();break;case"ArrowRight":if(this.state.actions.ArrowLeft)return;case"Tab":{let g=!e.autoComplete.rightKey||!e.autoComplete.tabKey;if(!a&&s&&g&&!this.state.editing){t.preventDefault();var h=this.dropdown.getMappedValue(i);return this.input.autocomplete.set.call(this,h),!1}return!0}case"Enter":t.preventDefault(),e.hooks.suggestionClick(t,{tagify:this,tagData:i,suggestionElm:s}).then(()=>{if(s)return this.dropdown.selectOption(s),s=this.dropdown.getNextOrPrevOption(s,!r),void this.dropdown.highlightOption(s);this.dropdown.hide(),a||this.addTags(this.state.inputText.trim(),!0)}).catch(g=>Tagify.logger.warn(g));break;case"Backspace":{if(a||this.state.editing.scope)return;const g=this.input.raw.call(this);g!=""&&g.charCodeAt(0)!=8203||(e.backspace===!0?this.removeTags():e.backspace=="edit"&&setTimeout(this.editTag.bind(this),0))}}})}},onMouseOver(t){var e=t.target.closest(this.settings.classNames.dropdownItemSelector);this.dropdown.highlightOption(e)},onMouseLeave(t){this.dropdown.highlightOption()},onClick(t){if(t.button==0&&t.target!=this.DOM.dropdown&&t.target!=this.DOM.dropdown.content){var e=t.target.closest(this.settings.classNames.dropdownItemSelector),s=this.dropdown.getSuggestionDataByNode(e);this.state.actions.selectOption=!0,setTimeout(()=>this.state.actions.selectOption=!1,50),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:s,suggestionElm:e}).then(()=>{e?this.dropdown.selectOption(e,t):this.dropdown.hide()}).catch(i=>Tagify.logger.warn(i))}},onScroll(t){var e=t.target,s=e.scrollTop/(e.scrollHeight-e.parentNode.clientHeight)*100;this.trigger("dropdown:scroll",{percentage:Math.round(s)})}}},refilter(t){t=t||this.state.dropdown.query||"",this.suggestedListItems=this.dropdown.filterListItems(t),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger("dropdown:updated",this.DOM.dropdown)},getSuggestionDataByNode(t){var e=t&&t.getAttribute("value");return this.suggestedListItems.find(s=>s.value==e)||null},getNextOrPrevOption(t){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];var s=this.dropdown.getAllSuggestionsRefs(),i=s.findIndex(a=>a===t);return e?s[i+1]:s[i-1]},highlightOption(t,e){var s,i=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(i),this.state.ddItemElm.removeAttribute("aria-selected")),!t)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);s=this.dropdown.getSuggestionDataByNode(t),this.state.ddItemData=s,this.state.ddItemElm=t,t.classList.add(i),t.setAttribute("aria-selected",!0),e&&(t.parentNode.scrollTop=t.clientHeight+t.offsetTop-t.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,s),this.dropdown.position())},selectOption(t,e){var s=this.settings,i=s.dropdown,a=i.clearOnSelect,n=i.closeOnSelect;if(!t)return this.addTags(this.state.inputText,!0),void(n&&this.dropdown.hide());e=e||{};var o=t.getAttribute("value"),r=o=="noMatch",h=s.mode=="mix",g=this.suggestedListItems.find(f=>(f.value??f)==o);if(this.trigger("dropdown:select",{data:g,elm:t,event:e}),o&&(g||r)){if(this.state.editing){let f=this.normalizeTags([g])[0];g=s.transformTag.call(this,f)||f,this.onEditTagDone(null,x({__isValid:!0},g))}else this[h?"addMixTags":"addTags"]([g||this.input.raw.call(this)],a);(h||this.DOM.input.parentNode)&&(setTimeout(()=>{this.DOM.input.focus(),this.toggleFocusClass(!0)}),n&&setTimeout(this.dropdown.hide.bind(this)),t.addEventListener("transitionend",()=>{this.dropdown.fillHeaderFooter(),setTimeout(()=>t.remove(),100)},{once:!0}),t.classList.add(this.settings.classNames.dropdownItemHidden))}else n&&setTimeout(this.dropdown.hide.bind(this))},selectAll(t){this.suggestedListItems.length=0,this.dropdown.hide(),this.dropdown.filterListItems("");var e=this.dropdown.filterListItems("");return t||(e=this.state.dropdown.suggestions),this.addTags(e,!0),this},filterListItems(t,e){var s,i,a,n,o,r=this.settings,h=r.dropdown,g=(e=e||{},[]),f=[],u=r.whitelist,O=h.maxItems>=0?h.maxItems:1/0,b=h.searchKeys,C=0;if(!(t=r.mode=="select"&&this.value.length&&this.value[0][r.tagTextProp]==t?"":t)||!b.length)return g=h.includeSelectedTags?u:u.filter(N=>!this.isTagDuplicate(M(N)?N.value:N)),this.state.dropdown.suggestions=g,g.slice(0,O);function D(N,L){return L.toLowerCase().split(" ").every(W=>N.includes(W.toLowerCase()))}for(o=h.caseSensitive?""+t:(""+t).toLowerCase();C<u.length;C++){let N,L;s=u[C]instanceof Object?u[C]:{value:u[C]};let W=Object.keys(s).some(P=>b.includes(P))?b:["value"];h.fuzzySearch&&!e.exact?(a=W.reduce((P,R)=>P+" "+(s[R]||""),"").toLowerCase().trim(),h.accentedSearch&&(a=B(a),o=B(o)),N=a.indexOf(o)==0,L=a===o,i=D(a,o)):(N=!0,i=W.some(P=>{var R=""+(s[P]||"");return h.accentedSearch&&(R=B(R),o=B(o)),h.caseSensitive||(R=R.toLowerCase()),L=R===o,e.exact?R===o:R.indexOf(o)==0})),n=!h.includeSelectedTags&&this.isTagDuplicate(M(s)?s.value:s),i&&!n&&(L&&N?f.push(s):h.sortby=="startsWith"&&N?g.unshift(s):g.push(s))}return this.state.dropdown.suggestions=f.concat(g),typeof h.sortby=="function"?h.sortby(f.concat(g),o):f.concat(g).slice(0,O)},getMappedValue(t){var e=this.settings.dropdown.mapValueTo;return e?typeof e=="function"?e(t):t[e]||t.value:t.value},createListHTML(t){return x([],t).map((e,s)=>{typeof e!="string"&&typeof e!="number"||(e={value:e});var i=this.dropdown.getMappedValue(e);return i=typeof i=="string"&&this.settings.dropdown.escapeHTML?S(i):i,this.settings.templates.dropdownItem.apply(this,[c(c({},e),{},{mappedValue:i}),this])}).join("")}};function st(){this.dropdown={};for(let t in this._dropdown)this.dropdown[t]=typeof this._dropdown[t]=="function"?this._dropdown[t].bind(this):this._dropdown[t];this.dropdown.refs()}var at=c(c({},it),{},{refs(){this.DOM.dropdown=this.parseTemplate("dropdown",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-wrapper']")},getHeaderRef(){return this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-header']")},getFooterRef(){return this.DOM.dropdown.querySelector("[data-selector='tagify-suggestions-footer']")},getAllSuggestionsRefs(){return[...this.DOM.dropdown.content.querySelectorAll(this.settings.classNames.dropdownItemSelector)]},show(t){var e,s,i,a=this.settings,n=a.mode=="mix"&&!a.enforceWhitelist,o=!a.whitelist||!a.whitelist.length,r=a.dropdown.position=="manual";if(t=t===void 0?this.state.inputText:t,!(o&&!n&&!a.templates.dropdownItemNoMatch||a.dropdown.enable===!1||this.state.isLoading||this.settings.readonly)){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(t),t&&!this.suggestedListItems.length&&(this.trigger("dropdown:noMatch",t),a.templates.dropdownItemNoMatch&&(i=a.templates.dropdownItemNoMatch.call(this,{value:t}))),!i){if(this.suggestedListItems.length)t&&n&&!this.state.editing.scope&&!v(this.suggestedListItems[0].value,t)&&this.suggestedListItems.unshift({value:t});else{if(!t||!n||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:t}]}s=""+(M(e=this.suggestedListItems[0])?e.value:e),a.autoComplete&&s&&s.indexOf(t)==0&&this.input.autocomplete.suggest.call(this,e)}this.dropdown.fill(i),a.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.querySelector(a.classNames.dropdownItemSelector)),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=t||!0,this.state.dropdown.query=t,this.setStateSelection(),r||setTimeout(()=>{this.dropdown.position(),this.dropdown.render()}),setTimeout(()=>{this.trigger("dropdown:show",this.DOM.dropdown)})}},hide(t){var e=this.DOM,s=e.scope,i=e.dropdown,a=this.settings.dropdown.position=="manual"&&!t;if(i&&document.body.contains(i)&&!a)return window.removeEventListener("resize",this.dropdown.position),this.dropdown.events.binding.call(this,!1),s.setAttribute("aria-expanded",!1),i.parentNode.removeChild(i),setTimeout(()=>{this.state.dropdown.visible=!1},100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger("dropdown:hide",i),this},toggle(t){this.dropdown[this.state.dropdown.visible&&!t?"hide":"show"]()},getAppendTarget(){var t=this.settings.dropdown;return typeof t.appendTarget=="function"?t.appendTarget():t.appendTarget},render(){var t,e,s,i=(t=this.DOM.dropdown,(s=t.cloneNode(!0)).style.cssText="position:fixed; top:-9999px; opacity:0",document.body.appendChild(s),e=s.clientHeight,s.parentNode.removeChild(s),e),a=this.settings,n=typeof a.dropdown.enabled=="number"&&a.dropdown.enabled>=0,o=this.dropdown.getAppendTarget();return n?(this.DOM.scope.setAttribute("aria-expanded",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(a.classNames.dropdownInital),this.dropdown.position(i),o.appendChild(this.DOM.dropdown),setTimeout(()=>this.DOM.dropdown.classList.remove(a.classNames.dropdownInital))),this):this},fill(t){t=typeof t=="string"?t:this.dropdown.createListHTML(t||this.suggestedListItems);var e,s=this.settings.templates.dropdownContent.call(this,t);this.DOM.dropdown.content.innerHTML=(e=s)?e.replace(/\>[\r\n ]+\</g,"><").split(/>\s+</).join("><").trim():""},fillHeaderFooter(){var t=this.dropdown.filterListItems(this.state.dropdown.query),e=this.parseTemplate("dropdownHeader",[t]),s=this.parseTemplate("dropdownFooter",[t]),i=this.dropdown.getHeaderRef(),a=this.dropdown.getFooterRef();e&&(i==null||i.parentNode.replaceChild(e,i)),s&&(a==null||a.parentNode.replaceChild(s,a))},position(t){var e=this.settings.dropdown,s=this.dropdown.getAppendTarget();if(e.position!="manual"&&s){var i,a,n,o,r,h,g,f,u,O=this.DOM.dropdown,b=e.RTL,C=s===document.body,D=s===this.DOM.scope,N=C?window.pageYOffset:s.scrollTop,L=document.fullscreenElement||document.webkitFullscreenElement||document.documentElement,W=L.clientHeight,P=Math.max(L.clientWidth||0,window.innerWidth||0)>480?e.position:"all",R=this.DOM[P=="input"?"input":"scope"];if(t=t||O.clientHeight,this.state.dropdown.visible){if(P=="text"?(n=(i=function(){const A=document.getSelection();if(A.rangeCount){const j=A.getRangeAt(0),V=j.startContainer,Z=j.startOffset;let G,X;if(Z>0)return X=document.createRange(),X.setStart(V,Z-1),X.setEnd(V,Z),G=X.getBoundingClientRect(),{left:G.right,top:G.top,bottom:G.bottom};if(V.getBoundingClientRect)return V.getBoundingClientRect()}return{left:-9999,top:-9999}}()).bottom,a=i.top,o=i.left,r="auto"):(h=function(A){var j=0,V=0;for(A=A.parentNode;A&&A!=L;)j+=A.offsetTop||0,V+=A.offsetLeft||0,A=A.parentNode;return{top:j,left:V}}(s),i=R.getBoundingClientRect(),a=D?-1:i.top-h.top,n=(D?i.height:i.bottom-h.top)-1,o=D?-1:i.left-h.left,r=i.width+"px"),!C){let A=function(){for(var j=0,V=e.appendTarget.parentNode;V;)j+=V.scrollTop||0,V=V.parentNode;return j}();a+=A,n+=A}a=Math.floor(a),n=Math.ceil(n),f=((g=e.placeAbove??W-i.bottom<t)?a:n)+N,u=`left: ${o+(b&&i.width||0)+window.pageXOffset}px;`,O.style.cssText=`${u}; top: ${f}px; min-width: ${r}; max-width: ${r}`,O.setAttribute("placement",g?"top":"bottom"),O.setAttribute("position",P)}}}});const U="@yaireo/tagify/";var tt,nt={empty:"empty",exceed:"number of tags exceeded",pattern:"pattern mismatch",duplicate:"already exists",notAllowed:"not allowed"},ot={wrapper:(t,e)=>`<tags class="${e.classNames.namespace} ${e.mode?`${e.classNames[e.mode+"Mode"]}`:""} ${t.className}"
                    ${e.readonly?"readonly":""}
                    ${e.disabled?"disabled":""}
                    ${e.required?"required":""}
                    ${e.mode==="select"?"spellcheck='false'":""}
                    tabIndex="-1">
            <span ${!e.readonly&&e.userInput?"contenteditable":""} tabIndex="0" data-placeholder="${e.placeholder||"&#8203;"}" aria-placeholder="${e.placeholder||""}"
                class="${e.classNames.input}"
                role="textbox"
                aria-autocomplete="both"
                aria-multiline="${e.mode=="mix"}"></span>
                &#8203;
        </tags>`,tag(t,e){let s=e.settings;return`<tag title="${t.title||t.value}"
                    contenteditable='false'
                    spellcheck='false'
                    tabIndex="${s.a11y.focusableTags?0:-1}"
                    class="${s.classNames.tag} ${t.class||""}"
                    ${this.getAttributes(t)}>
            <x title='' class="${s.classNames.tagX}" role='button' aria-label='remove tag'></x>
            <div>
                <span class="${s.classNames.tagText}">${t[s.tagTextProp]||t.value}</span>
            </div>
        </tag>`},dropdown(t){var e=t.dropdown;return`<div class="${e.position=="manual"?"":t.classNames.dropdown} ${e.classname}" role="listbox" aria-labelledby="dropdown" dir="${e.RTL?"rtl":""}">
                    <div data-selector='tagify-suggestions-wrapper' class="${t.classNames.dropdownWrapper}"></div>
                </div>`},dropdownContent(t){var e=this.settings.templates,s=this.state.dropdown.suggestions;return`
            ${e.dropdownHeader.call(this,s)}
            ${t}
            ${e.dropdownFooter.call(this,s)}
        `},dropdownItem(t){return`<div ${this.getAttributes(t)}
                    class='${this.settings.classNames.dropdownItem} ${t.class||""}'
                    tabindex="0"
                    role="option">${t.mappedValue||t.value}</div>`},dropdownHeader(t){return`<header data-selector='tagify-suggestions-header' class="${this.settings.classNames.dropdownHeader}"></header>`},dropdownFooter(t){var e=t.length-this.settings.dropdown.maxItems;return e>0?`<footer data-selector='tagify-suggestions-footer' class="${this.settings.classNames.dropdownFooter}">
                ${e} more items. Refine your search.
            </footer>`:""},dropdownItemNoMatch:null},rt={customBinding(){this.customEventsList.forEach(t=>{this.on(t,this.settings.callbacks[t])})},binding(){let t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];var e,s=this.settings,i=this.events.callbacks,a=t?"addEventListener":"removeEventListener";if(!this.state.mainEvents||!t){for(var n in this.state.mainEvents=t,t&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on("tagify.removeAllTags",this.removeAllTags.bind(this))),e=this.listeners.main=this.listeners.main||{focus:["input",i.onFocusBlur.bind(this)],keydown:["input",i.onKeydown.bind(this)],click:["scope",i.onClickScope.bind(this)],dblclick:s.mode!="select"&&["scope",i.onDoubleClickScope.bind(this)],paste:["input",i.onPaste.bind(this)],drop:["input",i.onDrop.bind(this)],compositionstart:["input",i.onCompositionStart.bind(this)],compositionend:["input",i.onCompositionEnd.bind(this)]})e[n]&&this.DOM[e[n][0]][a](n,e[n][1]);clearInterval(this.listeners.main.originalInputValueObserverInterval),this.listeners.main.originalInputValueObserverInterval=setInterval(i.observeOriginalInputValue.bind(this),500);var o=this.listeners.main.inputMutationObserver||new MutationObserver(i.onInputDOMChange.bind(this));o.disconnect(),s.mode=="mix"&&o.observe(this.DOM.input,{childList:!0})}},bindGlobal(t){var e,s=this.events.callbacks,i=t?"removeEventListener":"addEventListener";if(this.listeners&&(t||!this.listeners.global))for(e of(this.listeners.global=this.listeners.global||[{type:this.isIE?"keydown":"input",target:this.DOM.input,cb:s[this.isIE?"onInputIE":"onInput"].bind(this)},{type:"keydown",target:window,cb:s.onWindowKeyDown.bind(this)},{type:"blur",target:this.DOM.input,cb:s.onFocusBlur.bind(this)},{type:"click",target:document,cb:s.onClickAnywhere.bind(this),useCapture:!0}],this.listeners.global))e.target[i](e.type,e.cb,!!e.useCapture)},unbindGlobal(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur(t){var g,f;var e=this.settings,s=t.target?this.trim(t.target.textContent):"",i=(f=(g=this.value)==null?void 0:g[0])==null?void 0:f[e.tagTextProp],a=t.type,n=e.dropdown.enabled>=0,o={relatedTarget:t.relatedTarget},r=this.state.actions.selectOption&&(n||!e.dropdown.closeOnSelect),h=this.state.actions.addNew&&n;if(a=="blur"){if(t.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate(),e.onChangeAfterBlur&&this.triggerChangeEvent()}if(!r&&!h)if(this.state.hasFocus=a=="focus"&&+new Date,this.toggleFocusClass(this.state.hasFocus),e.mode!="mix"){if(a=="focus")return this.trigger("focus",o),void(e.dropdown.enabled!==0&&e.userInput||this.state.dropdown.visible||this.dropdown.show(this.value.length?"":void 0));a=="blur"&&(this.trigger("blur",o),this.loading(!1),e.mode=="select"&&i===s&&(s=""),s&&!this.state.actions.selectOption&&e.addTagOnBlur&&e.addTagOn.includes("blur")&&this.addTags(s,!0)),this.DOM.input.removeAttribute("style"),this.dropdown.hide()}else a=="focus"?this.trigger("focus",o):t.type=="blur"&&(this.trigger("blur",o),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onCompositionStart(t){this.state.composing=!0},onCompositionEnd(t){this.state.composing=!1},onWindowKeyDown(t){var e,s=document.activeElement,i=q.call(this,s)&&this.DOM.scope.contains(document.activeElement),a=i&&s.hasAttribute("readonly");if(i&&!a)switch(e=s.nextElementSibling,t.key){case"Backspace":this.settings.readonly||(this.removeTags(s),(e||this.DOM.input).focus());break;case"Enter":setTimeout(this.editTag.bind(this),0,s)}},onKeydown(t){var e=this.settings;if(!this.state.composing&&e.userInput){e.mode=="select"&&e.enforceWhitelist&&this.value.length&&t.key!="Tab"&&t.preventDefault();var s=this.trim(t.target.textContent);this.trigger("keydown",{event:t}),e.hooks.beforeKeyDown(t,{tagify:this}).then(i=>{if(e.mode=="mix"){switch(t.key){case"Left":case"ArrowLeft":this.state.actions.ArrowLeft=!0;break;case"Delete":case"Backspace":if(this.state.editing)return;var a=document.getSelection(),n=t.key=="Delete"&&a.anchorOffset==(a.anchorNode.length||0),o=a.anchorNode.previousSibling,r=a.anchorNode.nodeType==1||!a.anchorOffset&&o&&o.nodeType==1&&a.anchorNode.previousSibling;y(this.DOM.input.innerHTML);var h,g,f,u=this.getTagElms(),O=a.anchorNode.length===1&&a.anchorNode.nodeValue==String.fromCharCode(8203);if(e.backspace=="edit"&&r)return h=a.anchorNode.nodeType==1?null:a.anchorNode.previousElementSibling,setTimeout(this.editTag.bind(this),0,h),void t.preventDefault();if(H()&&r instanceof Element)return f=k(r),r.hasAttribute("readonly")||r.remove(),this.DOM.input.focus(),void setTimeout(()=>{z(f),this.DOM.input.click()});if(a.anchorNode.nodeName=="BR")return;if((n||r)&&a.anchorNode.nodeType==1?g=a.anchorOffset==0?n?u[0]:null:u[Math.min(u.length,a.anchorOffset)-1]:n?g=a.anchorNode.nextElementSibling:r instanceof Element&&(g=r),a.anchorNode.nodeType==3&&!a.anchorNode.nodeValue&&a.anchorNode.previousElementSibling&&t.preventDefault(),(r||n)&&!e.backspace||a.type!="Range"&&!a.anchorOffset&&a.anchorNode==this.DOM.input&&t.key!="Delete")return void t.preventDefault();if(a.type!="Range"&&g&&g.hasAttribute("readonly"))return void z(k(g));t.key=="Delete"&&O&&I(a.anchorNode.nextSibling)&&this.removeTags(a.anchorNode.nextSibling),clearTimeout(tt),tt=setTimeout(()=>{var C=document.getSelection();y(this.DOM.input.innerHTML),!n&&C.anchorNode.previousSibling,this.value=[].map.call(u,(D,N)=>{var L=I(D);if(D.parentNode||L.readonly)return L;this.trigger("remove",{tag:D,index:N,data:L})}).filter(D=>D)},20)}return!0}var b=e.dropdown.position=="manual";switch(t.key){case"Backspace":e.mode=="select"&&e.enforceWhitelist&&this.value.length?this.removeTags():this.state.dropdown.visible&&e.dropdown.position!="manual"||t.target.textContent!=""&&s.charCodeAt(0)!=8203||(e.backspace===!0?this.removeTags():e.backspace=="edit"&&setTimeout(this.editTag.bind(this),0));break;case"Esc":case"Escape":if(this.state.dropdown.visible)return;t.target.blur();break;case"Down":case"ArrowDown":this.state.dropdown.visible||this.dropdown.show();break;case"ArrowRight":{let C=this.state.inputSuggestion||this.state.ddItemData;if(C&&e.autoComplete.rightKey)return void this.addTags([C],!0);break}case"Tab":{let C=e.mode=="select";if(!s||C)return!0;t.preventDefault()}case"Enter":if(this.state.dropdown.visible&&!b)return;t.preventDefault(),setTimeout(()=>{this.state.dropdown.visible&&!b||this.state.actions.selectOption||!e.addTagOn.includes(t.key.toLowerCase())||this.addTags(s,!0)})}}).catch(i=>i)}},onInput(t){this.postUpdate();var e=this.settings;if(e.mode=="mix")return this.events.callbacks.onMixTagsInput.call(this,t);var s=this.input.normalize.call(this,void 0,{trim:!1}),i=s.length>=e.dropdown.enabled,a={value:s,inputElm:this.DOM.input},n=this.validateTag({value:s});e.mode=="select"&&this.toggleScopeValidation(n),a.isValid=n,this.state.inputText!=s&&(this.input.set.call(this,s,!1),s.search(e.delimiters)!=-1?this.addTags(s)&&this.input.set.call(this):e.dropdown.enabled>=0&&this.dropdown[i?"show":"hide"](s),this.trigger("input",a))},onMixTagsInput(t){var e,s,i,a,n,o,r,h,g=this.settings,f=this.value.length,u=this.getTagElms(),O=document.createDocumentFragment(),b=window.getSelection().getRangeAt(0),C=[].map.call(u,D=>I(D).value);if(t.inputType=="deleteContentBackward"&&H()&&this.events.callbacks.onKeydown.call(this,{target:t.target,key:"Backspace"}),Y(this.getTagElms()),this.value.slice().forEach(D=>{D.readonly&&!C.includes(D.value)&&O.appendChild(this.createTagElem(D))}),O.childNodes.length&&(b.insertNode(O),this.setRangeAtStartEnd(!1,O.lastChild)),u.length!=f)return this.value=[].map.call(this.getTagElms(),D=>I(D)),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(o=window.getSelection()).rangeCount>0&&o.anchorNode.nodeType==3){if((b=o.getRangeAt(0).cloneRange()).collapse(!0),b.setStart(o.focusNode,0),i=(e=b.toString().slice(0,b.endOffset)).split(g.pattern).length-1,(s=e.match(g.pattern))&&(a=e.slice(e.lastIndexOf(s[s.length-1]))),a){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:a.match(g.pattern)[0],value:a.replace(g.pattern,"")},this.state.tag.baseOffset=o.baseOffset-this.state.tag.value.length,h=this.state.tag.value.match(g.delimiters))return this.state.tag.value=this.state.tag.value.replace(g.delimiters,""),this.state.tag.delimiters=h[0],this.addTags(this.state.tag.value,g.dropdown.clearOnSelect),void this.dropdown.hide();n=this.state.tag.value.length>=g.dropdown.enabled;try{r=(r=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&r.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch{}(r||i<this.state.mixMode.matchedPatternCount)&&(n=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=i}setTimeout(()=>{this.update({withoutChangeEvent:!0}),this.trigger("input",x({},this.state.tag,{textContent:this.DOM.input.textContent})),this.state.tag&&this.dropdown[n?"show":"hide"](this.state.tag.value)},10)},onInputIE(t){var e=this;setTimeout(function(){e.events.callbacks.onInput.call(e,t)})},observeOriginalInputValue(){this.DOM.originalInput.parentNode||this.destroy(),this.DOM.originalInput.value!=this.DOM.originalInput.tagifyValue&&this.loadOriginalValues()},onClickAnywhere(t){t.target==this.DOM.scope||this.DOM.scope.contains(t.target)||(this.toggleFocusClass(!1),this.state.hasFocus=!1,!this.settings.userInput&&this.dropdown.hide())},onClickScope(t){var e=this.settings,s=t.target.closest("."+e.classNames.tag),i=t.target===this.DOM.scope,a=+new Date-this.state.hasFocus;if(i&&e.mode!="select")this.DOM.input.focus();else{if(!t.target.classList.contains(e.classNames.tagX))return s&&!this.state.editing?(this.trigger("click",{tag:s,index:this.getNodeIndex(s),data:I(s),event:t}),void(e.editTags!==1&&e.editTags.clicks!==1&&e.mode!="select"||this.events.callbacks.onDoubleClickScope.call(this,t))):void(t.target==this.DOM.input&&(e.mode=="mix"&&this.fixFirefoxLastTagNoCaret(),a>500)?this.state.dropdown.visible?this.dropdown.hide():e.dropdown.enabled===0&&e.mode!="mix"&&this.dropdown.show(this.value.length?"":void 0):e.mode!="select"||e.dropdown.enabled!==0||this.state.dropdown.visible||(this.events.callbacks.onDoubleClickScope.call(this,c(c({},t),{},{target:this.getTagElms()[0]})),!e.userInput&&this.dropdown.show()));this.removeTags(t.target.parentNode)}},onPaste(t){t.preventDefault();var e,s,i,a=this.settings;if(a.mode=="select"&&a.enforceWhitelist||!a.userInput)return!1;a.readonly||(s=t.clipboardData||window.clipboardData,i=s.getData("Text"),a.hooks.beforePaste(t,{tagify:this,pastedText:i,clipboardData:s}).then(n=>{n===void 0&&(n=i),n&&(this.injectAtCaret(n,window.getSelection().getRangeAt(0)),this.settings.mode=="mix"?this.events.callbacks.onMixTagsInput.call(this,t):this.settings.pasteAsTags?e=this.addTags(this.state.inputText+n,!0):(this.state.inputText=n,this.dropdown.show(n))),this.trigger("paste",{event:t,pastedText:i,clipboardData:s,tagsElems:e})}).catch(n=>n))},onDrop(t){t.preventDefault()},onEditTagInput(t,e){var s=t.closest("."+this.settings.classNames.tag),i=this.getNodeIndex(s),a=I(s),n=this.input.normalize.call(this,t),o={[this.settings.tagTextProp]:n,__tagId:a.__tagId},r=this.validateTag(o);this.editTagChangeDetected(x(a,o))||t.originalIsValid!==!0||(r=!0),s.classList.toggle(this.settings.classNames.tagInvalid,r!==!0),a.__isValid=r,s.title=r===!0?a.title||a.value:r,n.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=n),this.dropdown.show(n)),this.trigger("edit:input",{tag:s,index:i,data:x({},this.value[i],{newValue:n}),event:e})},onEditTagPaste(t,e){var s=(e.clipboardData||window.clipboardData).getData("Text");e.preventDefault();var i=Q(s);this.setRangeAtStartEnd(!1,i)},onEditTagClick(t,e){this.events.callbacks.onClickScope.call(this,e)},onEditTagFocus(t){this.state.editing={scope:t,input:t.querySelector("[contenteditable]")}},onEditTagBlur(t,e){if(q.call(this,e.relatedTarget)&&e.relatedTarget.contains(e.target))this.dropdown.hide();else if(this.state.editing&&(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(t))){var s,i,a=this.settings,n=t.closest("."+a.classNames.tag),o=I(n),r=this.input.normalize.call(this,t),h={[a.tagTextProp]:r,__tagId:o.__tagId},g=o.__originalData,f=this.editTagChangeDetected(x(o,h)),u=this.validateTag(h);if(r)if(f){if(s=this.hasMaxTags(),i=x({},g,{[a.tagTextProp]:this.trim(r),__isValid:u}),a.transformTag.call(this,i,g),(u=(!s||g.__isValid===!0)&&this.validateTag(i))!==!0){if(this.trigger("invalid",{data:i,tag:n,message:u}),a.editTags.keepInvalid)return;a.keepInvalidTags?i.__isValid=u:i=g}else a.keepInvalidTags&&(delete i.title,delete i["aria-invalid"],delete i.class);this.onEditTagDone(n,i)}else this.onEditTagDone(n,g);else this.onEditTagDone(n)}},onEditTagkeydown(t,e){if(!this.state.composing)switch(this.trigger("edit:keydown",{event:t}),t.key){case"Esc":case"Escape":this.state.editing=!1,e.__tagifyTagData.__originalData.value?e.parentNode.replaceChild(e.__tagifyTagData.__originalHTML,e):e.remove();break;case"Enter":case"Tab":t.preventDefault(),setTimeout(()=>t.target.blur(),0)}},onDoubleClickScope(t){var e,s,i=t.target.closest("."+this.settings.classNames.tag),a=I(i),n=this.settings;i&&a.editable!==!1&&(e=i.classList.contains(this.settings.classNames.tagEditing),s=i.hasAttribute("readonly"),n.readonly||e||s||!this.settings.editTags||!n.userInput||this.editTag(i),this.toggleFocusClass(!0),n.mode!="select"&&this.trigger("dblclick",{tag:i,index:this.getNodeIndex(i),data:I(i)}))},onInputDOMChange(t){t.forEach(s=>{s.addedNodes.forEach(i=>{var a;if(i.outerHTML=="<div><br></div>")i.replaceWith(document.createElement("br"));else if(i.nodeType==1&&i.querySelector(this.settings.classNames.tagSelector)){let n=document.createTextNode("");i.childNodes[0].nodeType==3&&i.previousSibling.nodeName!="BR"&&(n=document.createTextNode(`
`)),i.replaceWith(n,...[...i.childNodes].slice(0,-1)),z(n)}else if(q.call(this,i))if(((a=i.previousSibling)==null?void 0:a.nodeType)!=3||i.previousSibling.textContent||i.previousSibling.remove(),i.previousSibling&&i.previousSibling.nodeName=="BR"){i.previousSibling.replaceWith(`
​`);let n=i.nextSibling,o="";for(;n;)o+=n.textContent,n=n.nextSibling;o.trim()&&z(i.previousSibling)}else i.previousSibling&&!I(i.previousSibling)||i.before("​")}),s.removedNodes.forEach(i=>{i&&i.nodeName=="BR"&&q.call(this,e)&&(this.removeTags(e),this.fixFirefoxLastTagNoCaret())})});var e=this.DOM.input.lastChild;e&&e.nodeValue==""&&e.remove(),e&&e.nodeName=="BR"||this.DOM.input.appendChild(document.createElement("br"))}}};function F(t,e){if(!t){F.logger.warn("input element not found",t);const i=new Proxy(this,{get:()=>()=>i});return i}if(t.__tagify)return F.logger.warn("input element is already Tagified - Same instance is returned.",t),t.__tagify;var s;x(this,function(i){var a=document.createTextNode("");function n(o,r,h){h&&r.split(/\s+/g).forEach(g=>a[o+"EventListener"].call(a,g,h))}return{off(o,r){return n("remove",o,r),this},on(o,r){return r&&typeof r=="function"&&n("add",o,r),this},trigger(o,r,h){var g;if(h=h||{cloneData:!0},o)if(i.settings.isJQueryPlugin)o=="remove"&&(o="removeTag"),jQuery(i.DOM.originalInput).triggerHandler(o,[r]);else{try{var f=typeof r=="object"?r:{value:r};if((f=h.cloneData?x({},f):f).tagify=this,r.event&&(f.event=this.cloneEvent(r.event)),r instanceof Object)for(var u in r)r[u]instanceof HTMLElement&&(f[u]=r[u]);g=new CustomEvent(o,{detail:f})}catch(O){Tagify.logger.warn(O)}a.dispatchEvent(g)}}}}(this)),this.isFirefox=/firefox|fxios/i.test(navigator.userAgent)&&!/seamonkey/i.test(navigator.userAgent),this.isIE=window.document.documentMode,e=e||{},this.getPersistedData=(s=e.id,i=>{let a,n="/"+i;if(localStorage.getItem(U+s+"/v",1)==1)try{a=JSON.parse(localStorage[U+s+n])}catch{}return a}),this.setPersistedData=(i=>i?(localStorage.setItem(U+i+"/v",1),(a,n)=>{let o="/"+n,r=JSON.stringify(a);a&&n&&(localStorage.setItem(U+i+o,r),dispatchEvent(new Event("storage")))}):()=>{})(e.id),this.clearPersistedData=(i=>a=>{const n=U+"/"+i+"/";if(a)localStorage.removeItem(n+a);else for(let o in localStorage)o.includes(n)&&localStorage.removeItem(o)})(e.id),this.applySettings(t,e),this.state={inputText:"",editing:!1,composing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(t),st.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),t.autofocus&&this.DOM.input.focus(),t.__tagify=this}return F.prototype={_dropdown:at,placeCaretAfterNode:z,getSetTagData:I,helpers:{sameStr:v,removeCollectionProp:w,omit:T,isObject:M,parseHTML:E,escapeHTML:S,extend:x,concatWithoutDups:_,getUID:K,isNodeTag:q},customEventsList:["change","add","remove","invalid","input","paste","click","keydown","focus","blur","edit:input","edit:beforeUpdate","edit:updated","edit:start","edit:keydown","dropdown:show","dropdown:hide","dropdown:select","dropdown:updated","dropdown:noMatch","dropdown:scroll"],dataProps:["__isValid","__removed","__originalData","__originalHTML","__tagId"],trim(t){return this.settings.trim&&t&&typeof t=="string"?t.trim():t},parseHTML:E,templates:ot,parseTemplate(t,e){return E((t=this.settings.templates[t]||t).apply(this,e))},set whitelist(t){const e=t&&Array.isArray(t);this.settings.whitelist=e?t:[],this.setPersistedData(e?t:[],"whitelist")},get whitelist(){return this.settings.whitelist},generateClassSelectors(t){for(let e in t){let s=e;Object.defineProperty(t,s+"Selector",{get(){return"."+this[s].split(" ")[0]}})}},applySettings(t,e){var n,o;J.templates=this.templates;var s=x({},J,e.mode=="mix"?{dropdown:{position:"text"}}:{}),i=this.settings=x({},s,e);if(i.disabled=t.hasAttribute("disabled"),i.readonly=i.readonly||t.hasAttribute("readonly"),i.placeholder=S(t.getAttribute("placeholder")||i.placeholder||""),i.required=t.hasAttribute("required"),this.generateClassSelectors(i.classNames),i.dropdown.includeSelectedTags===void 0&&(i.dropdown.includeSelectedTags=i.duplicates),this.isIE&&(i.autoComplete=!1),["whitelist","blacklist"].forEach(r=>{var h=t.getAttribute("data-"+r);h&&(h=h.split(i.delimiters))instanceof Array&&(i[r]=h)}),"autoComplete"in e&&!M(e.autoComplete)&&(i.autoComplete=J.autoComplete,i.autoComplete.enabled=e.autoComplete),i.mode=="mix"&&(i.pattern=i.pattern||/@/,i.autoComplete.rightKey=!0,i.delimiters=e.delimiters||null,i.tagTextProp&&!i.dropdown.searchKeys.includes(i.tagTextProp)&&i.dropdown.searchKeys.push(i.tagTextProp)),t.pattern)try{i.pattern=new RegExp(t.pattern)}catch{}if(i.delimiters){i._delimiters=i.delimiters;try{i.delimiters=new RegExp(this.settings.delimiters,"g")}catch{}}i.disabled&&(i.userInput=!1),this.TEXTS=c(c({},nt),i.texts||{}),(i.mode!="select"||(n=e.dropdown)!=null&&n.enabled)&&i.userInput||(i.dropdown.enabled=0),i.dropdown.appendTarget=((o=e.dropdown)==null?void 0:o.appendTarget)||document.body;let a=this.getPersistedData("whitelist");Array.isArray(a)&&(this.whitelist=Array.isArray(i.whitelist)?_(i.whitelist,a):a)},getAttributes(t){var e,s=this.getCustomAttributes(t),i="";for(e in s)i+=" "+e+(t[e]!==void 0?`="${s[e]}"`:"");return i},getCustomAttributes(t){if(!M(t))return"";var e,s={};for(e in t)e.slice(0,2)!="__"&&e!="class"&&t.hasOwnProperty(e)&&t[e]!==void 0&&(s[e]=S(t[e]));return s},setStateSelection(){var t=window.getSelection(),e={anchorOffset:t.anchorOffset,anchorNode:t.anchorNode,range:t.getRangeAt&&t.rangeCount&&t.getRangeAt(0)};return this.state.selection=e,e},getCSSVars(){var t=getComputedStyle(this.DOM.scope,null),e;this.CSSVars={tagHideTransition:(s=>{let i=s.value;return s.unit=="s"?1e3*i:i})(function(s){if(!s)return{};var i=(s=s.trim().split(" ")[0]).split(/\d+/g).filter(a=>a).pop().trim();return{value:+s.split(i).filter(a=>a)[0].trim(),unit:i}}((e="tag-hide-transition",t.getPropertyValue("--"+e))))}},build(t){var e=this.DOM,s=t.closest("label");this.settings.mixMode.integrated?(e.originalInput=null,e.scope=t,e.input=t):(e.originalInput=t,e.originalInput_tabIndex=t.tabIndex,e.scope=this.parseTemplate("wrapper",[t,this.settings]),e.input=e.scope.querySelector(this.settings.classNames.inputSelector),t.parentNode.insertBefore(e.scope,t),t.tabIndex=-1),s&&s.setAttribute("for","")},destroy(){this.events.unbindGlobal.call(this),this.DOM.scope.parentNode.removeChild(this.DOM.scope),this.DOM.originalInput.tabIndex=this.DOM.originalInput_tabIndex,delete this.DOM.originalInput.__tagify,this.dropdown.hide(!0),clearTimeout(this.dropdownHide__bindEventsTimeout),clearInterval(this.listeners.main.originalInputValueObserverInterval)},loadOriginalValues(t){var e,s=this.settings;if(this.state.blockChangeEvent=!0,t===void 0){const i=this.getPersistedData("value");t=i&&!this.DOM.originalInput.value?i:s.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value}if(this.removeAllTags(),t)if(s.mode=="mix")this.parseMixTags(t),(e=this.DOM.input.lastChild)&&e.tagName=="BR"||this.DOM.input.insertAdjacentHTML("beforeend","<br>");else{try{JSON.parse(t)instanceof Array&&(t=JSON.parse(t))}catch{}this.addTags(t,!0).forEach(i=>i&&i.classList.add(s.classNames.tagNoAnimation))}else this.postUpdate();this.state.lastOriginalValueReported=s.mixMode.integrated?"":this.DOM.originalInput.value},cloneEvent(t){var e={};for(var s in t)s!="path"&&(e[s]=t[s]);return e},loading(t){return this.state.isLoading=t,this.DOM.scope.classList[t?"add":"remove"](this.settings.classNames.scopeLoading),this},tagLoading(t,e){return t&&t.classList[e?"add":"remove"](this.settings.classNames.tagLoading),this},toggleClass(t,e){typeof t=="string"&&this.DOM.scope.classList.toggle(t,e)},toggleScopeValidation(t){var e=t===!0||t===void 0;!this.settings.required&&t&&t===this.TEXTS.empty&&(e=!0),this.toggleClass(this.settings.classNames.tagInvalid,!e),this.DOM.scope.title=e?"":t},toggleFocusClass(t){this.toggleClass(this.settings.classNames.focus,!!t)},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var t=this.DOM.originalInput,e=this.state.lastOriginalValueReported!==t.value,s=new CustomEvent("change",{bubbles:!0});e&&(this.state.lastOriginalValueReported=t.value,s.simulated=!0,t._valueTracker&&t._valueTracker.setValue(Math.random()),t.dispatchEvent(s),this.trigger("change",this.state.lastOriginalValueReported),t.value=this.state.lastOriginalValueReported)}},events:rt,fixFirefoxLastTagNoCaret(){},setRangeAtStartEnd(t,e){if(e){t=typeof t=="number"?t:!!t,e=e.lastChild||e;var s=document.getSelection();if(s.focusNode instanceof Element&&!this.DOM.input.contains(s.focusNode))return!0;try{s.rangeCount>=1&&["Start","End"].forEach(i=>s.getRangeAt(0)["set"+i](e,t||e.length))}catch{}}},insertAfterTag(t,e){if(e=e||this.settings.mixMode.insertAfterTag,t&&t.parentNode&&e)return e=typeof e=="string"?document.createTextNode(e):e,t.parentNode.insertBefore(e,t.nextSibling),e},editTagChangeDetected(t){var e=t.__originalData;for(var s in e)if(!this.dataProps.includes(s)&&t[s]!=e[s])return!0;return!1},getTagTextNode(t){return t.querySelector(this.settings.classNames.tagTextSelector)},setTagTextNode(t,e){this.getTagTextNode(t).innerHTML=S(e)},editTag(t,e){t=t||this.getLastTag(),e=e||{},this.dropdown.hide();var s=this.settings,i=this.getTagTextNode(t),a=this.getNodeIndex(t),n=I(t),o=this.events.callbacks,r=!0;if(i){if(!(n instanceof Object&&"editable"in n)||n.editable)return n=I(t,{__originalData:x({},n),__originalHTML:t.cloneNode(!0)}),I(n.__originalHTML,n.__originalData),i.setAttribute("contenteditable",!0),t.classList.add(s.classNames.tagEditing),i.addEventListener("click",o.onEditTagClick.bind(this,t)),i.addEventListener("focus",o.onEditTagFocus.bind(this,t)),i.addEventListener("blur",o.onEditTagBlur.bind(this,this.getTagTextNode(t))),i.addEventListener("input",o.onEditTagInput.bind(this,i)),i.addEventListener("paste",o.onEditTagPaste.bind(this,i)),i.addEventListener("keydown",h=>o.onEditTagkeydown.call(this,h,t)),i.addEventListener("compositionstart",o.onCompositionStart.bind(this)),i.addEventListener("compositionend",o.onCompositionEnd.bind(this)),e.skipValidation||(r=this.editTagToggleValidity(t)),i.originalIsValid=r,this.trigger("edit:start",{tag:t,index:a,data:n,isValid:r}),i.focus(),this.setRangeAtStartEnd(!1,i),s.dropdown.enabled===0&&this.dropdown.show(),this.state.hasFocus=!0,this}else F.logger.warn("Cannot find element in Tag template: .",s.classNames.tagTextSelector)},editTagToggleValidity(t,e){var s;if(e=e||I(t))return(s=!("__isValid"in e)||e.__isValid===!0)||this.removeTagsFromValue(t),this.update(),t.classList.toggle(this.settings.classNames.tagNotAllowed,!s),e.__isValid=s,e.__isValid;F.logger.warn("tag has no data: ",t,e)},onEditTagDone(t,e){var n;t=t||this.state.editing.scope,e=e||{};var s,i={tag:t,index:this.getNodeIndex(t),previousData:I(t),data:e},a=this.settings;this.trigger("edit:beforeUpdate",i,{cloneData:!1}),this.state.editing=!1,delete e.__originalData,delete e.__originalHTML,t&&((s=e[a.tagTextProp])?(n=s.trim)!=null&&n.call(s):!(a.tagTextProp in e)&&e.value)?(t=this.replaceTag(t,e),this.editTagToggleValidity(t,e),a.a11y.focusableTags?t.focus():z(t)):t&&this.removeTags(t),this.trigger("edit:updated",i),this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag(t,e){e&&e.value!==""&&e.value!==void 0||(e=t.__tagifyTagData),e.__isValid&&e.__isValid!=1&&x(e,this.getInvalidTagAttrs(e,e.__isValid));var s=this.createTagElem(e);return t.parentNode.replaceChild(s,t),this.updateValueByDOMTags(),s},updateValueByDOMTags(){this.value.length=0,[].forEach.call(this.getTagElms(),t=>{t.classList.contains(this.settings.classNames.tagNotAllowed.split(" ")[0])||this.value.push(I(t))}),this.update()},injectAtCaret(t,e){var i;if(!(e=e||((i=this.state.selection)==null?void 0:i.range))&&t)return this.appendMixTags(t),this;let s=Q(t,e);return this.setRangeAtStartEnd(!1,s),this.updateValueByDOMTags(),this.update(),this},input:{set(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];var s=this.settings.dropdown.closeOnSelect;this.state.inputText=t,e&&(this.DOM.input.innerHTML=S(""+t)),!t&&s&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},raw(){return this.DOM.input.textContent},validate(){var t=!this.state.inputText||this.validateTag({value:this.state.inputText})===!0;return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!t),t},normalize(t,e){var s=t||this.DOM.input,i=[];s.childNodes.forEach(a=>a.nodeType==3&&i.push(a.nodeValue)),i=i.join(`
`);try{i=i.replace(/(?:\r\n|\r|\n)/g,this.settings.delimiters.source.charAt(0))}catch{}return i=i.replace(/\s/g," "),e!=null&&e.trim?this.trim(i):i},autocomplete:{suggest(t){if(this.settings.autoComplete.enabled){typeof(t=t||{value:""})!="object"&&(t={value:t});var e=this.dropdown.getMappedValue(t);if(typeof e!="number"){var s=this.state.inputText.toLowerCase(),i=e.substr(0,this.state.inputText.length).toLowerCase(),a=e.substring(this.state.inputText.length);e&&this.state.inputText&&i==s?(this.DOM.input.setAttribute("data-suggest",a),this.state.inputSuggestion=t):(this.DOM.input.removeAttribute("data-suggest"),delete this.state.inputSuggestion)}}},set(t){var e=this.DOM.input.getAttribute("data-suggest"),s=t||(e?this.state.inputText+e:null);return!!s&&(this.settings.mode=="mix"?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+s)):(this.input.set.call(this,s),this.setRangeAtStartEnd(!1,this.DOM.input)),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx(t){return this.value.findIndex(e=>e.__tagId==(t||{}).__tagId)},getNodeIndex(t){var e=0;if(t)for(;t=t.previousElementSibling;)e++;return e},getTagElms(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];var i="."+[...this.settings.classNames.tag.split(" "),...e].join(".");return[].slice.call(this.DOM.scope.querySelectorAll(i))},getLastTag(){var t=this.DOM.scope.querySelectorAll(`${this.settings.classNames.tagSelector}:not(.${this.settings.classNames.tagHide}):not([readonly])`);return t[t.length-1]},isTagDuplicate(t,e,s){var i=0;if(this.settings.mode=="select")return!1;for(let a of this.value)v(this.trim(""+t),a.value,e)&&s!=a.__tagId&&i++;return i},getTagIndexByValue(t){var e=[],s=this.settings.dropdown.caseSensitive;return this.getTagElms().forEach((i,a)=>{i.__tagifyTagData&&v(this.trim(i.__tagifyTagData.value),t,s)&&e.push(a)}),e},getTagElmByValue(t){var e=this.getTagIndexByValue(t)[0];return this.getTagElms()[e]},flashTag(t){t&&(t.classList.add(this.settings.classNames.tagFlash),setTimeout(()=>{t.classList.remove(this.settings.classNames.tagFlash)},100))},isTagBlacklisted(t){return t=this.trim(t.toLowerCase()),this.settings.blacklist.filter(e=>(""+e).toLowerCase()==t).length},isTagWhitelisted(t){return!!this.getWhitelistItem(t)},getWhitelistItem(t,e,s){e=e||"value";var i,a=this.settings;return(s=s||a.whitelist).some(n=>{var o=typeof n=="string"?n:n[e]||n.value;if(v(o,t,a.dropdown.caseSensitive,a.trim))return i=typeof n=="string"?{value:n}:n,!0}),i||e!="value"||a.tagTextProp=="value"||(i=this.getWhitelistItem(t,a.tagTextProp,s)),i},validateTag(t){var e=this.settings,s="value"in t?"value":e.tagTextProp,i=this.trim(t[s]+"");return(t[s]+"").trim()?e.mode!="mix"&&e.pattern&&e.pattern instanceof RegExp&&!e.pattern.test(i)?this.TEXTS.pattern:!e.duplicates&&this.isTagDuplicate(i,e.dropdown.caseSensitive,t.__tagId)?this.TEXTS.duplicate:this.isTagBlacklisted(i)||e.enforceWhitelist&&!this.isTagWhitelisted(i)?this.TEXTS.notAllowed:!e.validate||e.validate(t):this.TEXTS.empty},getInvalidTagAttrs(t,e){return{"aria-invalid":!0,class:`${t.class||""} ${this.settings.classNames.tagNotAllowed}`.trim(),title:e}},hasMaxTags(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly(t,e){var s=this.settings;document.activeElement.blur(),s[e||"readonly"]=t,this.DOM.scope[(t?"set":"remove")+"Attribute"](e||"readonly",!0),this.settings.userInput=!0,this.setContentEditable(!t)},setContentEditable(t){this.settings.userInput&&(this.DOM.input.contentEditable=t,this.DOM.input.tabIndex=t?0:-1)},setDisabled(t){this.setReadonly(t,"disabled")},normalizeTags(t){var e=this.settings,s=e.whitelist,i=e.delimiters,a=e.mode,n=e.tagTextProp,o=[],r=!!s&&s[0]instanceof Object,h=Array.isArray(t),g=h&&t[0].value,f=u=>(u+"").split(i).filter(O=>O).map(O=>({[n]:this.trim(O),value:this.trim(O)}));if(typeof t=="number"&&(t=t.toString()),typeof t=="string"){if(!t.trim())return[];t=f(t)}else h&&(t=[].concat(...t.map(u=>u.value!=null?u:f(u))));return r&&!g&&(t.forEach(u=>{var O=o.map(D=>D.value),b=this.dropdown.filterListItems.call(this,u[n],{exact:!0});this.settings.duplicates||(b=b.filter(D=>!O.includes(D.value)));var C=b.length>1?this.getWhitelistItem(u[n],n,b):b[0];C&&C instanceof Object?o.push(C):a!="mix"&&(u.value==null&&(u.value=u[n]),o.push(u))}),o.length&&(t=o)),t},parseMixTags(t){var e=this.settings,s=e.mixTagsInterpolator,i=e.duplicates,a=e.transformTag,n=e.enforceWhitelist,o=e.maxTags,r=e.tagTextProp,h=[];t=t.split(s[0]).map((f,u)=>{var O,b,C,D=f.split(s[1]),N=D[0],L=h.length==o;try{if(N==+N)throw Error;b=JSON.parse(N)}catch{b=this.normalizeTags(N)[0]||{value:N}}if(a.call(this,b),L||!(D.length>1)||n&&!this.isTagWhitelisted(b.value)||!i&&this.isTagDuplicate(b.value)){if(f)return u?s[0]+f:f}else b[O=b[r]?r:"value"]=this.trim(b[O]),C=this.createTagElem(b),h.push(b),C.classList.add(this.settings.classNames.tagNoAnimation),D[0]=C.outerHTML,this.value.push(b);return D.join("")}).join(""),this.DOM.input.innerHTML=t,this.DOM.input.appendChild(document.createTextNode("")),this.DOM.input.normalize();var g=this.getTagElms();return g.forEach((f,u)=>I(f,h[u])),this.update({withoutChangeEvent:!0}),Y(g,this.state.hasFocus),t},replaceTextWithNode(t,e){if(this.state.tag||e){e=e||this.state.tag.prefix+this.state.tag.value;var s,i,a=this.state.selection||window.getSelection(),n=a.anchorNode,o=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return n.splitText(a.anchorOffset-o),(s=n.nodeValue.lastIndexOf(e))==-1||(i=n.splitText(s),t&&n.parentNode.replaceChild(t,i)),!0}},prepareNewTagNode(t,e){e=e||{};var s=this.settings,i=[],a={},n=Object.assign({},t,{value:t.value+""});if(t=Object.assign({},n),s.transformTag.call(this,t),t.__isValid=this.hasMaxTags()||this.validateTag(t),t.__isValid!==!0){if(e.skipInvalid)return;if(x(a,this.getInvalidTagAttrs(t,t.__isValid),{__preInvalidData:n}),t.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(t.value)),!s.createInvalidTags)return void i.push(t.value)}return"readonly"in t&&(t.readonly?a["aria-readonly"]=!0:delete t.readonly),{tagElm:this.createTagElem(t,a),tagData:t,aggregatedInvalidInput:i}},postProcessNewTagNode(t,e){var s=this.settings,i=e.__isValid;i&&i===!0?(this.value.push(e),this.trigger("add",{tag:t,index:this.value.length-1,data:e})):(this.trigger("invalid",{data:e,index:this.value.length,tag:t,message:i}),s.keepInvalidTags||setTimeout(()=>this.removeTags(t,!0),1e3)),this.dropdown.position()},selectTag(t,e){if(!this.settings.enforceWhitelist||this.isTagWhitelisted(e.value)){this.state.actions.selectOption&&setTimeout(()=>this.setRangeAtStartEnd(!1,this.DOM.input));var s=this.getLastTag();return s?this.replaceTag(s,e):this.appendTag(t),this.value[0]=e,this.update(),this.trigger("add",{tag:t,data:e}),[t]}},addEmptyTag(t){var e=x({value:""},t||{}),s=this.createTagElem(e);I(s,e),this.appendTag(s),this.editTag(s,{skipValidation:!0}),this.toggleFocusClass(!0)},addTags(t,e,s){var i=[],a=this.settings,n=[],o=document.createDocumentFragment();if(!t||t.length==0)return i;switch(t=this.normalizeTags(t),a.mode){case"mix":return this.addMixTags(t);case"select":e=!1,this.removeAllTags()}return this.DOM.input.removeAttribute("style"),t.forEach(r=>{const h=this.prepareNewTagNode(r,{skipInvalid:s||a.skipInvalid});if(!h)return;const g=h.tagElm;if(r=h.tagData,n=h.aggregatedInvalidInput,i.push(g),a.mode=="select")return this.selectTag(g,r);o.appendChild(g),this.postProcessNewTagNode(g,r)}),this.appendTag(o),this.update(),t.length&&e&&(this.input.set.call(this,a.createInvalidTags?"":n.join(a._delimiters)),this.setRangeAtStartEnd(!1,this.DOM.input)),a.dropdown.enabled&&this.dropdown.refilter(),i},addMixTags(t){if((t=this.normalizeTags(t))[0].prefix||this.state.tag)return this.prefixedTextToTag(t[0]);var e=document.createDocumentFragment();return t.forEach(s=>{const i=this.prepareNewTagNode(s);e.appendChild(i.tagElm),this.postProcessNewTagNode(tagElm,i.tagData)}),this.appendMixTags(e),e},appendMixTags(t){var e=!!this.state.selection;e?this.injectAtCaret(t):(this.DOM.input.focus(),(e=this.setStateSelection()).range.setStart(this.DOM.input,e.range.endOffset),e.range.setEnd(this.DOM.input,e.range.endOffset),this.DOM.input.appendChild(t),this.updateValueByDOMTags(),this.update())},prefixedTextToTag(t){var o;var e,s,i=this.settings,a=(o=this.state.tag)==null?void 0:o.delimiters;if(t.prefix=t.prefix||this.state.tag?this.state.tag.prefix:(i.pattern.source||i.pattern)[0],s=this.prepareNewTagNode(t),e=s.tagElm,this.replaceTextWithNode(e)||this.DOM.input.appendChild(e),setTimeout(()=>e.classList.add(this.settings.classNames.tagNoAnimation),300),this.value.push(s.tagData),this.update(),!a){var n=this.insertAfterTag(e)||e;setTimeout(z,0,n)}return this.state.tag=null,this.postProcessNewTagNode(e,s.tagData),e},appendTag(t){var e=this.DOM,s=e.input;e.scope.insertBefore(t,s)},createTagElem(t,e){t.__tagId=K();var s,i=x({},t,c({value:S(t.value+"")},e));return function(a){for(var n,o=document.createNodeIterator(a,NodeFilter.SHOW_TEXT,null,!1);n=o.nextNode();)n.textContent.trim()||n.parentNode.removeChild(n)}(s=this.parseTemplate("tag",[i,this])),I(s,t),s},reCheckInvalidTags(){var t=this.settings;this.getTagElms(t.classNames.tagNotAllowed).forEach((e,s)=>{var i=I(e),a=this.hasMaxTags(),n=this.validateTag(i),o=n===!0&&!a;if(t.mode=="select"&&this.toggleScopeValidation(n),o)return i=i.__preInvalidData?i.__preInvalidData:{value:i.value},this.replaceTag(e,i);e.title=a||n})},removeTags(t,e,s){var i,a=this.settings;if(t=t&&t instanceof HTMLElement?[t]:t instanceof Array?t:t?[t]:[this.getLastTag()],i=t.reduce((n,o)=>{o&&typeof o=="string"&&(o=this.getTagElmByValue(o));var r=I(o);return o&&r&&!r.readonly&&n.push({node:o,idx:this.getTagIdx(r),data:I(o,{__removed:!0})}),n},[]),s=typeof s=="number"?s:this.CSSVars.tagHideTransition,a.mode=="select"&&(s=0,this.input.set.call(this)),i.length==1&&a.mode!="select"&&i[0].node.classList.contains(a.classNames.tagNotAllowed)&&(e=!0),i.length)return a.hooks.beforeRemoveTag(i,{tagify:this}).then(()=>{function n(o){o.node.parentNode&&(o.node.parentNode.removeChild(o.node),e?a.keepInvalidTags&&this.trigger("remove",{tag:o.node,index:o.idx}):(this.trigger("remove",{tag:o.node,index:o.idx,data:o.data}),this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),a.keepInvalidTags&&this.reCheckInvalidTags()))}s&&s>10&&i.length==1?(function(o){o.node.style.width=parseFloat(window.getComputedStyle(o.node).width)+"px",document.body.clientTop,o.node.classList.add(a.classNames.tagHide),setTimeout(n.bind(this),s,o)}).call(this,i[0]):i.forEach(n.bind(this)),e||(this.removeTagsFromValue(i.map(o=>o.node)),this.update(),a.mode=="select"&&this.setContentEditable(!0))}).catch(n=>{})},removeTagsFromDOM(){[].slice.call(this.getTagElms()).forEach(t=>t.parentNode.removeChild(t))},removeTagsFromValue(t){(t=Array.isArray(t)?t:[t]).forEach(e=>{var s=I(e),i=this.getTagIdx(s);i>-1&&this.value.splice(i,1)})},removeAllTags(t){t=t||{},this.value=[],this.settings.mode=="mix"?this.DOM.input.innerHTML="":this.removeTagsFromDOM(),this.dropdown.refilter(),this.dropdown.position(),this.state.dropdown.visible&&setTimeout(()=>{this.DOM.input.focus()}),this.settings.mode=="select"&&(this.input.set.call(this),this.setContentEditable(!0)),this.update(t)},postUpdate(){var i,a;this.state.blockChangeEvent=!1;var t=this.settings,e=t.classNames,s=t.mode=="mix"?t.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value.trim():this.value.length+this.input.raw.call(this).length;this.toggleClass(e.hasMaxTags,this.value.length>=t.maxTags),this.toggleClass(e.hasNoTags,!this.value.length),this.toggleClass(e.empty,!s),t.mode=="select"&&this.toggleScopeValidation((a=(i=this.value)==null?void 0:i[0])==null?void 0:a.__isValid)},setOriginalInputValue(t){var e=this.DOM.originalInput;this.settings.mixMode.integrated||(e.value=t,e.tagifyValue=e.value,this.setPersistedData(t,"value"))},update(t){clearTimeout(this.debouncedUpdateTimeout),this.debouncedUpdateTimeout=setTimeout((function(){var e=this.getInputValue();this.setOriginalInputValue(e),this.settings.onChangeAfterBlur&&(t||{}).withoutChangeEvent||this.state.blockChangeEvent||this.triggerChangeEvent(),this.postUpdate()}).bind(this),100)},getInputValue(){var t=this.getCleanValue();return this.settings.mode=="mix"?this.getMixedTagsAsString(t):t.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(t):JSON.stringify(t):""},getCleanValue(t){return w(t||this.value,this.dataProps)},getMixedTagsAsString(){var t="",e=this,s=this.settings,i=s.originalInputValueFormat||JSON.stringify,a=s.mixTagsInterpolator;return function n(o){o.childNodes.forEach(r=>{if(r.nodeType==1){const h=I(r);if(r.tagName=="BR"&&(t+=`\r
`),h&&q.call(e,r)){if(h.__removed)return;t+=a[0]+i(T(h,e.dataProps))+a[1]}else r.getAttribute("style")||["B","I","U"].includes(r.tagName)?t+=r.textContent:r.tagName!="DIV"&&r.tagName!="P"||(t+=`\r
`,n(r))}else t+=r.textContent})}(this.DOM.input),t}},F.prototype.removeTag=F.prototype.removeTags,F.logger={enabled:!1,log(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.enabled},warn(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.enabled}},F})})(et);var ht=et.exports;const gt=dt(ht);class ct{constructor(l){this.fieldHandle=l.fieldHandle,this.metaBadgeInfo=l.metaBadgeInfo,this.maxDescriptionLength=l.maxDescriptionLength,this.initMetadataFieldButtons(),this.addMetaBadgesToUi()}initMetadataFieldButtons(){let l=this,d="fields-"+this.fieldHandle+"-meta-details-tabs";this.metaDetailsTabs=document.querySelectorAll("#"+d+" div.btn");let c="fields-"+this.fieldHandle+"-meta-details-body";if(this.metaDetailsBodyContainers=document.querySelectorAll("#"+c+" div.matrixblock"),!(this.metaDetailsBodyContainers.length<1)){for(let p of this.metaDetailsTabs)p.addEventListener("click",function(v){let w=$(v.target);w.is("div")||(w=w.closest("div.btn"));let T=$("#fields-projectsMetadata-meta-details-tabs .active");if(w.is(T))return!0;let y=w.attr("data-type"),E="#fields-"+l.fieldHandle+"-meta-details-body .fields-"+y,k=document.querySelector(E);for(let S of l.metaDetailsTabs)S.classList.remove("active");for(let S of l.metaDetailsBodyContainers)S.style.display="none";$(k).show(),w.addClass("active")});$(this.metaDetailsBodyContainers[0]).show(),this.metaDetailsTabs[0].classList.add("active")}}addMetaBadgesToUi(){let l=this;for(let d in this.metaBadgeInfo){let c=this.metaBadgeInfo[d].type,p=this.metaBadgeInfo[d].handle;this.metaBadgeInfo[d].badgeClass;let v="#fields-"+p+"-label",w="#fields-"+p+"-field input",T=$(w);if(p==="title"&&(v="#title-label",T=$("#title")),$(v).find(".sprout-info").length===0){let y=$(v);$("#fields-sprout-meta-badge-"+p).appendTo(y).removeClass("hidden")}if(c==="optimizedTitleField"&&(T.attr("maxlength",60),new Garnish.NiceText(T,{showCharsLeft:!0})),c==="optimizedDescriptionField"){let y="#fields-"+p+"-field textarea",E=$(y);E.attr("maxlength",l.maxDescriptionLength),new Garnish.NiceText(E,{showCharsLeft:!0})}}}}class pt{constructor(){let l=document.querySelectorAll("input.sprout-tagify-field");for(let d of l)new gt(d,{originalInputValueFormat:c=>c.map(p=>p.value).join(",")})}}window.SproutMetaMetadataField=ct;window.SproutInitTagifyUI=pt;typeof Craft.SproutMeta>"u"&&(Craft.SproutMeta={});Craft.SproutMeta.EditableTable=Garnish.Base.extend({initialized:!1,id:null,baseName:null,columns:null,sorter:null,biggestId:-1,$table:null,$tbody:null,$addRowBtn:null,init:function(m,l,d,c){this.id=m,this.baseName=l,this.columns=d,this.setSettings(c,Craft.SproutMeta.EditableTable.defaults),this.$table=$("#"+m),this.$tbody=this.$table.children("tbody"),this.sorter=new Craft.DataTableSorter(this.$table,{helperClass:"editabletablesorthelper",copyDraggeeInputValuesToHelper:!0}),this.isVisible()?this.initialize():this.addListener(Garnish.$win,"resize","initializeIfVisible")},isVisible:function(){return this.$table.height()>0},initialize:function(){if(this.initialized)return;this.initialized=!0,this.removeListener(Garnish.$win,"resize");const m=this.$tbody.children();for(let l=0;l<m.length;l++)new Craft.SproutMeta.EditableTable.Row(this,m[l]);this.$addRowBtn=this.$table.next(".buttons").children(".add"),this.addListener(this.$addRowBtn,"activate","addRow")},initializeIfVisible:function(){this.isVisible()&&this.initialize()},addRow:function(){const m=this.settings.rowIdPrefix+(this.biggestId+1),l=Craft.SproutMeta.EditableTable.getRowHtml(m,this.columns,this.baseName,{}),d=$(l).appendTo(this.$tbody);new Craft.SproutMeta.EditableTable.Row(this,d),this.sorter.addItems(d),d.find("input,textarea,select").first().focus(),this.settings.onAddRow(d)}},{textualColTypes:["singleline","multiline","number"],defaults:{rowIdPrefix:"",onAddRow:$.noop,onDeleteRow:$.noop},getRowHtml:function(m,l,d,c){let p='<tr data-id="'+m+'">';for(let v in l){const w=l[v],T=d+"["+m+"]["+v+"]",y=typeof c[v]<"u"?c[v]:"",E=Craft.inArray(w.type,Craft.SproutMeta.EditableTable.textualColTypes);switch(p+='<td class="'+(E?"textual":"")+" "+(typeof w.class<"u"?w.class:"")+'"'+(typeof w.width<"u"?' width="'+w.width+'"':"")+">",w.type){case"selectOther":{d.indexOf("ownership")>-1?p+='<div class="field sprout-selectother"><div class="select sprout-selectotherdropdown"><select onchange="setDefault(this)" name="'+T+'">':p+='<div class="field sprout-selectother"><div class="select sprout-selectotherdropdown"><select name="'+T+'">';let S=!1,M="disabled selected";for(let x in w.options){const _=w.options[x];if(typeof _.optgroup<"u")S?p+="</optgroup>":S=!0,p+='<optgroup label="'+_.optgroup+'">';else{const B=typeof _.label<"u"?_.label:_,H=typeof _.value<"u"?_.value:x,K=typeof _.disabled<"u"?_.disabled:!1;p+="<option "+M+' value="'+H+'"'+(H===y?" selected":"")+(K?" disabled":"")+">"+B+"</option>"}M=""}S&&(p+="</optgroup>"),p+="</select></div>",p+='<div class="texticon clearable sprout-selectothertext hidden"><input class="text fullwidth" type="text" name="'+T+'" value="" autocomplete="off"><div class="clear" title="Clear"></div></div>',p+="</div>";break}case"checkbox":{p+='<input type="hidden" name="'+T+'"><input type="checkbox" name="'+T+'" value="1"'+(y?" checked":"")+">";break}default:p+='<input class="text fullwidth" type="text" name="'+T+'" value="'+y+'">'}p+="</td>"}return p+='<td class="thin action"><a class="move icon" title="'+Craft.t("sprout","Reorder")+'"></a></td><td class="thin action"><a class="delete icon" title="'+Craft.t("sprout","Delete")+'"></a></td></tr>',p}});Craft.SproutMeta.EditableTable.Row=Garnish.Base.extend({table:null,id:null,niceTexts:null,$tr:null,$tds:null,$textareas:null,$deleteBtn:null,init:function(m,l){this.table=m,this.$tr=$(l),this.$tds=this.$tr.children();const d=parseInt(this.$tr.attr("data-id").substr(this.table.settings.rowIdPrefix.length));d>this.table.biggestId&&(this.table.biggestId=d),this.$textareas=$(),this.niceTexts=[];const c={};let p=0;for(let w in this.table.columns){let T=this.table.columns[w];if(Craft.inArray(T.type,Craft.SproutMeta.EditableTable.textualColTypes)){const y=$("textarea",this.$tds[p]);this.$textareas=this.$textareas.add(y),this.addListener(y,"focus","onTextareaFocus"),this.addListener(y,"mousedown","ignoreNextTextareaFocus"),this.niceTexts.push(new Garnish.NiceText(y,{onHeightChange:$.proxy(this,"onTextareaHeightChange")})),(T.type==="singleline"||T.type==="number")&&(this.addListener(y,"keypress",{type:T.type},"validateKeypress"),this.addListener(y,"textchange",{type:T.type},"validateValue")),c[w]=y}p++}this.initSproutFields(),this.onTextareaHeightChange();for(let w in this.table.columns){let T=this.table.columns[w];T.autopopulate&&typeof c[T.autopopulate]<"u"&&!c[w].val()&&new Craft.HandleGenerator(c[w],c[T.autopopulate])}const v=this.$tr.children().last().find(".delete");this.addListener(v,"click","deleteRow")},initSproutFields:function(){Craft.SproutFields.initFields(this.$tr)},onTextareaFocus:function(m){this.onTextareaHeightChange();const l=$(m.currentTarget);if(l.data("ignoreNextFocus")){l.data("ignoreNextFocus",!1);return}setTimeout(function(){const d=l.val();if(typeof l[0].setSelectionRange<"u"){const c=d.length*2;l[0].setSelectionRange(0,c)}else l.val(d)},0)},ignoreNextTextareaFocus:function(m){$.data(m.currentTarget,"ignoreNextFocus",!0)},validateKeypress:function(m){const l=m.keyCode?m.keyCode:m.charCode;!Garnish.isCtrlKeyPressed(m)&&(l===Garnish.RETURN_KEY||m.data.type==="number"&&!Craft.inArray(l,Craft.SproutMeta.EditableTable.Row.numericKeyCodes))&&m.preventDefault()},validateValue:function(m){let l;if(m.data.type==="number"){const d=m.currentTarget.value.match(/^\s*(-?[\d.]*)/);d!==null?l=d[1]:l=""}else l=m.currentTarget.value.replace(/[\r\n]/g,"");l!==m.currentTarget.value&&(m.currentTarget.value=l)},onTextareaHeightChange:function(){let m=-1;for(let d=0;d<this.niceTexts.length;d++)this.niceTexts[d].height>m&&(m=this.niceTexts[d].height);this.$textareas.css("min-height",m);const l=this.$textareas.first().parent().height();l>m&&this.$textareas.css("min-height",l)},deleteRow:function(){this.table.sorter.removeItems(this.$tr),this.$tr.remove(),this.table.settings.onDeleteRow(this.$tr)}},{numericKeyCodes:[9,8,37,38,39,40,45,91,46,190,48,49,50,51,52,53,54,55,56,57]});class ut{constructor(l){let d=this;this.fieldHandle=l.fieldHandle,this.selectFieldId=l.selectFieldId;let c="#fields-"+this.fieldHandle+"-meta-details-body "+this.selectFieldId,p=document.querySelector(c);if(p!==null){let v=p.options[p.selectedIndex].value;this.currentContainerId=this.getTargetContainerId(v),this.currentContainer=document.getElementById(this.currentContainerId),this.currentContainer&&this.currentContainer.classList.remove("hidden"),p.addEventListener("change",function(w){d.toggleOpenGraphFieldContainer(w,d)})}}toggleOpenGraphFieldContainer(l,d){let c=l.target,p=c.options[c.selectedIndex].value,v=d.getTargetContainerId(p),w=document.getElementById(v);w&&w.classList.remove("hidden"),d.currentContainer&&d.currentContainer.classList.add("hidden"),d.currentContainerId=v,d.currentContainer=w}getTargetContainerId(l){return"#fields-"+l}}window.MetaDetailsToggle=ut;class mt{constructor(l){this.items=l.items,this.mainEntityValues=l.mainEntityValues,this.initLegacyCode(),this.initOtherLegacyCode()}initLegacyCode(){let l=this,d="",c=function(k,S){$.each(k,function(M,x){M>=S&&$(x).html(d)})},p=function(k,S){$.each(k,function(M,x){M>=S&&$(x).closest("div.organizationinfo-dropdown").addClass("hidden")})},v=function(k){k.closest("div.organizationinfo-dropdown").removeClass("hidden")},w=function(k,S){let M="",x="";$.each(S,function(_,B){x=_.replace(/([A-Z][^A-Z\b])/g," $1").trim(),M+='<option value="'+_+'">'+x+"</option>",B&&$.each(B,function(H,K){x="&nbsp;&nbsp;&nbsp;"+H.replace(/([A-Z][^A-Z\b])/g," $1").trim(),M+='<option value="'+H+'">'+x+"</option>"})}),k.append(M)},T=$(".mainentity-firstdropdown select"),y=$(".mainentity-seconddropdown select"),E="";T.on("change",function(){E=T.val(),c($(".organization-info :input"),1),p($(".organization-info :input"),1),!(typeof l.items[E]>"u"||E===""||l.items[E].length<=0)&&l.items[E][0]&&(v(y),w(y,l.items[E][0]))}),y.on("change",function(){y.val()})}initOtherLegacyCode(){let d=this.mainEntityValues;$(".mainentity-firstdropdown select").change(function(){this.value==="barrelstrength-sprout-schema-personschema"?$(".mainentity-seconddropdown select").addClass("hidden"):$(".mainentity-seconddropdown select").removeClass("hidden")}),d&&(d.hasOwnProperty("schemaTypeId")&&d.schemaTypeId&&$(".mainentity-firstdropdown select").val(d.schemaTypeId).change(),d.hasOwnProperty("schemaOverrideTypeId")&&d.schemaOverrideTypeId&&$(".mainentity-seconddropdown select").val(d.schemaOverrideTypeId).change())}}window.SproutMetaWebsiteIdentitySettings=mt;class ft{constructor(l){this.items=l.items,this.websiteIdentity=l.websiteIdentity,this.firstDropdownId=l.firstDropdownId,this.secondDropdownId=l.secondDropdownId,this.thirdDropdownId=l.thirdDropdownId,this.initInfoIcons(),this.initWebsiteIdentityField(),this.moreWebsiteIdentityStuff()}initInfoIcons(){document.querySelectorAll("[data-additional-info]").forEach(function(d){let c=d.dataset.additionalInfo;document.getElementById(c+"-label").appendChild(d),d.classList.toggle("hidden")})}initWebsiteIdentityField(){let l=this,d=$(this.firstDropdownId),c=$(this.secondDropdownId),p=$(this.thirdDropdownId),v="",w="";d.on("change",function(){v=d.val(),l.clearDropDown($("#organization :input"),1),l.disableDropDown($("#organization :input"),1),v!==""&&l.items[v].hasOwnProperty("children")&&(l.enableDropDown(c),l.generateOptions(c,l.items[v].children))}),c.on("change",function(){if(v=$("#main-entity-first-dropdown").val(),w=c.val(),l.clearDropDown($("#organization :input"),2),l.disableDropDown($("#organization :input"),2),w==="")return;let T=l.items[v].children;for(let y=0;y<T.length;y++)if(T[y].name===w){T[y].hasOwnProperty("children")&&(l.enableDropDown(p),l.generateOptions(p,T[y].children));break}})}moreWebsiteIdentityStuff(){let l=this.websiteIdentity;l&&(l.hasOwnProperty("organizationSubTypes")&&l.organizationSubTypes[0]&&$("#main-entity-first-dropdown").val(l.organizationSubTypes[0]).trigger("change"),l.hasOwnProperty("organizationSubTypes")&&l.organizationSubTypes[1]&&$("#main-entity-second-dropdown").val(l.organizationSubTypes[1]).trigger("change"),l.hasOwnProperty("organizationSubTypes")&&l.organizationSubTypes[2]&&$("#main-entity-third-dropdown").val(l.organizationSubTypes[2]).trigger("change")),$("#identityType").change(function(){this.value==="Person"?($(".person-info").removeClass("hidden"),$(".organization-info").addClass("hidden")):($(".person-info").addClass("hidden"),$(".organization-info").removeClass("hidden")),this.value==="Organization"?($(".organization-info").removeClass("hidden"),$(".person-info").addClass("hidden"),$("#main-entity-first-dropdown").val()==="LocalBusiness"&&$("#localbusiness").removeClass("hidden")):($(".organization-info").addClass("hidden"),$(".person-info").removeClass("hidden"))}),$("#main-entity-first-dropdown").change(function(){this.value==="LocalBusiness"?$("#localbusiness").removeClass("hidden"):$("#localbusiness").addClass("hidden")})}clearDropDown(l,d){let c='<option value="" selected="selected"></option>';$.each(l,function(p,v){p>=d&&$(v).html(c)})}disableDropDown(l,d){$.each(l,function(c,p){c>=d&&$(p).closest("div.organizationinfo-dropdown").addClass("hidden")})}enableDropDown(l){l.closest("div.organizationinfo-dropdown").removeClass("hidden")}generateOptions(l,d){let c="",p="";for(let v=0;v<d.length;v++)p=d[v].name.replace(/([A-Z][^A-Z\b])/g," $1").trim(),c+='<option value="'+d[v].name+'">'+p+"</option>";l.append(c)}}window.SproutMetaWebsiteIdentity=ft;
//# sourceMappingURL=meta-23d3c209.js.map
