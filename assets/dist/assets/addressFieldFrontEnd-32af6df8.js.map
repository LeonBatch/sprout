{"version":3,"file":"addressFieldFrontEnd-32af6df8.js","sources":["../../src/forms-frontend/AddressField.js"],"sourcesContent":["/*\n * @link https://sprout.barrelstrengthdesign.com\n * @copyright Copyright (c) Barrel Strength Design LLC\n * @license https://craftcms.github.io/license\n */\n\nclass SproutFormsAddressField {\n\n    constructor(formId) {\n        this.formId = formId;\n        this.form = document.getElementById(this.formId);\n\n        this.countrySelectFields = this.form.querySelectorAll('.sprout-address-country-select');\n\n        // No need to continue if we don't have any Country Select fields\n        if (this.countrySelectFields.length === 0) {\n            return;\n        }\n\n        this.initCountrySelectFields();\n    }\n\n    initCountrySelectFields() {\n        let self = this;\n        for (let i = 0; i < this.countrySelectFields.length; i++) {\n            this.countrySelectFields[i].addEventListener('change', function(event) {\n                self.updateFormFields(this);\n            });\n        }\n    }\n\n    updateFormFields(countrySelectInput) {\n        let self = this;\n        this.form = countrySelectInput.closest('form');\n        let baseInputName = countrySelectInput.closest('[data-namespace]').dataset.namespace;\n\n        let data = {\n            action: 'sprout-base-fields/fields-address/update-address-form-html',\n            namespace: baseInputName,\n            countryCode: countrySelectInput.value,\n            overrideTemplatePaths: true\n        };\n\n        data[window.csrfTokenName] = this.form.querySelector('[name=\"' + window.csrfTokenName + '\"]').value;\n\n        let xhr = new XMLHttpRequest();\n        xhr.open('POST', '/', true);\n        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=utf-8');\n        xhr.setRequestHeader('Accept', 'application/json; charset=utf-8');\n\n        // When the country dropdown changes, update things\n        xhr.onreadystatechange = function() {\n            if (xhr.readyState === 4 && xhr.status === 200) {\n                let response = JSON.parse(xhr.response);\n                self.removeCountrySpecificElements();\n                let countrySpecificFields = self.form.querySelector('.sprout-address-country-fields');\n                countrySpecificFields.innerHTML = response.html;\n            }\n        };\n\n        let body = Object.keys(data).map(function(key) {\n            return encodeURIComponent(key) + '=' + encodeURIComponent(data[key])\n        }).join('&');\n\n        xhr.send(body);\n    }\n\n    removeCountrySpecificElements() {\n        let inputs = this.form.querySelectorAll('.sprout-address-onchange-country');\n        for (let key in inputs) {\n            if (inputs.hasOwnProperty(key)) {\n                let elem = inputs[key];\n                if (typeof elem.parentNode !== 'undefined') {\n                    elem.parentNode.removeChild(elem);\n                }\n            }\n        }\n    }\n}\n\nwindow.SproutFormsAddressField = SproutFormsAddressField;\n"],"names":["SproutFormsAddressField","formId","self","i","event","countrySelectInput","data","xhr","response","countrySpecificFields","body","key","inputs","elem"],"mappings":"AAAA;AAAA;AAAA;AAAA;AAAA,GAMA,MAAMA,CAAwB,CAE1B,YAAYC,EAAQ,CAChB,KAAK,OAASA,EACd,KAAK,KAAO,SAAS,eAAe,KAAK,MAAM,EAE/C,KAAK,oBAAsB,KAAK,KAAK,iBAAiB,gCAAgC,EAGlF,KAAK,oBAAoB,SAAW,GAIxC,KAAK,wBAAuB,CAC/B,CAED,yBAA0B,CACtB,IAAIC,EAAO,KACX,QAASC,EAAI,EAAGA,EAAI,KAAK,oBAAoB,OAAQA,IACjD,KAAK,oBAAoBA,CAAC,EAAE,iBAAiB,SAAU,SAASC,EAAO,CACnEF,EAAK,iBAAiB,IAAI,CAC1C,CAAa,CAER,CAED,iBAAiBG,EAAoB,CACjC,IAAIH,EAAO,KACX,KAAK,KAAOG,EAAmB,QAAQ,MAAM,EAG7C,IAAIC,EAAO,CACP,OAAQ,6DACR,UAJgBD,EAAmB,QAAQ,kBAAkB,EAAE,QAAQ,UAKvE,YAAaA,EAAmB,MAChC,sBAAuB,EACnC,EAEQC,EAAK,OAAO,aAAa,EAAI,KAAK,KAAK,cAAc,UAAY,OAAO,cAAgB,IAAI,EAAE,MAE9F,IAAIC,EAAM,IAAI,eACdA,EAAI,KAAK,OAAQ,IAAK,EAAI,EAC1BA,EAAI,iBAAiB,eAAgB,kDAAkD,EACvFA,EAAI,iBAAiB,SAAU,iCAAiC,EAGhEA,EAAI,mBAAqB,UAAW,CAChC,GAAIA,EAAI,aAAe,GAAKA,EAAI,SAAW,IAAK,CAC5C,IAAIC,EAAW,KAAK,MAAMD,EAAI,QAAQ,EACtCL,EAAK,8BAA6B,EAClC,IAAIO,EAAwBP,EAAK,KAAK,cAAc,gCAAgC,EACpFO,EAAsB,UAAYD,EAAS,IAC9C,CACb,EAEQ,IAAIE,EAAO,OAAO,KAAKJ,CAAI,EAAE,IAAI,SAASK,EAAK,CAC3C,OAAO,mBAAmBA,CAAG,EAAI,IAAM,mBAAmBL,EAAKK,CAAG,CAAC,CAC/E,CAAS,EAAE,KAAK,GAAG,EAEXJ,EAAI,KAAKG,CAAI,CAChB,CAED,+BAAgC,CAC5B,IAAIE,EAAS,KAAK,KAAK,iBAAiB,kCAAkC,EAC1E,QAASD,KAAOC,EACZ,GAAIA,EAAO,eAAeD,CAAG,EAAG,CAC5B,IAAIE,EAAOD,EAAOD,CAAG,EACjB,OAAOE,EAAK,WAAe,KAC3BA,EAAK,WAAW,YAAYA,CAAI,CAEvC,CAER,CACL,CAEA,OAAO,wBAA0Bb"}